
## 新要素詳細



### 排泄要素

- 世界設定のオプションから排泄要素を設定できる、デフォルトはオン
- サイドバーのステータス表示に排泄欲の項目を追加
  - 「ラベル」のサイドバーは、「欲求」の空きスペースにも排泄欲を組み込んであります。
  - 自己認識能力の特質を持っていると「排泄欲」がパーセント表示で分かるようになる。自己認識能力ってスゴイ。
- プレイヤーが食べたものが実際の貯蓄カロリーに足されるタイミングで、食べたものの容量と水分に応じて「排泄量」が増加する
- 「排泄量」が一定を超えると「排泄量」に応じて「排泄欲」が上昇し始める
  - 睡眠中は「排泄欲」の増加量が半減
- 「排泄欲」が一定を超えると排泄行動ができるようになる
- 排泄行動のデフォルトは「0」(ゼロ)キー、キーコンフィグで変更可能
- 排泄行動はいつでも可能で、3分間かかる
- 排泄行動が完了すると、「排泄量」「排泄欲」をゼロにして、「排泄量」に応じた量の排泄物を足元に落とし、多少の意欲がアップする
  - 家屋などのトイレや、クラフトで作れる車載トイレの地形上で排泄すると、さらに意欲にボーナス
  - 排泄完了時に、所持品の中の「紙製かつ、容積が0.1L～0.5Lかつ、不潔でない」アイテムをトイレットペーパーとして\*使用\*できる
    - トイレットペーパーを\*使用\*すると意欲が上昇する
    - 使わなくても特にペナルティはない
    - \*使用\*したアイテムは不潔になり、足元に落とす
    - アイテムのjsonに\*使用\*時の意欲とメッセージを指定できる
      - デフォルトではサンプルとして、札束や本物のトイレットペーパー等に指定してます
  - ウォシュレット付きトイレの上で排泄した場合、ウォシュレットを使える
    - 車の水1L、バッテリー500、1分で意欲が上がる
- 排泄しないまま「排泄欲」が上限を超えると漏らす
  - 漏らすと、即時・強制的に排泄すると同時に脚装備をすべて不潔にして、意欲がダウンする
    - 漏らしても、脚装備を1つも付けていなかった場合は、逆に意欲がアップする
- 排泄物はアイテムとしてバニラに存在する犬のフンとほぼ同等
- 車載トイレはeで調べることで水3Lを消費して流せる
- デバッグのプレイヤーの欲求編集で、「排泄量」「排泄欲」を確認・操作できるように

### リトルメイド拡張

- 同梱ModのLittlemaidをオンにすることで、同じく同梱のBattle_MaidのModに含まれる友好Mobの機能を拡張する
  - Battle Maidの原作者様に感謝と謝罪をしながら遊んでくださいね。
- 愛玩用リトルメイド(搾乳可能)からクラフトで、愛玩用リトルメイド(解放)を作って使用することで、愛玩用リトルメイドを友好Mobとして召喚できる
- 友好Mobのメイドさん(ショゴス)か、愛玩用メイドをeで調べることでペットメニューが開く
- メイド共通で、勝手に歩かない待機命令、コスチューム変更の命令ができる
- リトルメイドはそれに加えて、アイテム状態に戻す片付けと、喋らない命令ができる
- コスチュームを通常に戻すとき、1/10の確率で原作同梱タイルのコスチュームになる
- メイドと4種類の「Lovely Activity」（以下「遊び」）が行える
  - 遊びの種類は、「Kiss」「Petting」「Get Service」「\*Special\*」（英語版）
  - どの遊びでも10分かかり、主人の意欲が上昇する
  - 遊びの種類によってで主人とメイドの「Happiness」「Comfortness」の上昇値が異なる
  - メイドの「Comfortness」が最大になると40前後のMaid Pointが手に入り、メイドの「Fatigue」値が上昇する、「Fatigue」値は時間経過で減少する
    - 1回の遊びでメイドと主人の「Comfortness」が同時に最大になると、より多くのMaid Pointが手に入る
      - さらにショゴスメイドは1/5の確率でショゴスの卵を産む。ショゴスの卵は粉末卵に加工して食用にできる
  - 主人の「Comfortness」が最大になると大幅に意欲が上昇し、主人の疲労値（≒眠気）が上昇する
  - 「Comfortness」は「Heppiness」が高いほど上がりやすく、「Fatigue」が高いと上がりにくい
  - メイドの「Happiness」等の値は遊びが終わった後のメッセージによって大まかなヒントを得られる
  - 主人の「Confortness」等の値は＠のステータス画面で確認できる
- メイドはBattleMaidの元々のセリフに加えて、状況に応じた追加セリフをしゃべる
  -  主人との遊びの状況に応じて
  -  主人の就寝時と起床時
  - 自身のコスチューム状態について
  - 主人が脚防具を付けていない時
  - リトルメイド自身が敵に攻撃されている時
  - 特定のモンスターが視界内にいるとき
- メイドは主人が視界に入っていない時は喋らない
  - クラフト等の作業を妨害しないため。
    - 「北から"テケリ・リ！"が聞こえました！作業を中断しますか？(y/n)」
  - 判断基準はメイドから見えているかどうかなので、暗視力の差や視線トリックによって主人から見えない場所で喋って作業を邪魔する可能性も
- 主人が寝ているのを見るとショゴスメイドもリトルメイドも喋ったり動いたりしなくなる

### 車載シャワー

 - 車載シャワーブースを作って車に搭載し、eで調べることでシャワーを浴びられる
 -  シャワーを浴びるには、30Lの飲料水(水ではダメ)と2000のバッテリー(自動車バッテリー1個弱)のリソースを車のタンクから使う
 - シャワーを浴びるには、濡れると意欲が下がる衣服を全て脱ぐ必要がある
   - つまり[WATER_FRIENDLY]フラグがない衣類。
 - シャワーを浴びるには10分かかる
 - シャワーを浴びると意欲がアップし、全身ずぶ濡れになる
 - 電力5000消費で温かいシャワーを浴びることもできる
   - 温かいシャワーは意欲のボーナスが大きく、使用中に暖気を放出する
 - 水5Lとバッテリー200で手洗いだけをすることもできる
   - 小さく意欲が上がるだけだけど、トイレの後は手を洗う潔癖ロールプレイに。

### 衣類の香り

- 車載洗濯機で衣類や防具を洗濯するといい香りフラグが付く
  - このために、洗濯機が不潔でないアイテムを拒否しないように変更
- いい香りフラグは、着ている部位が水などで濡れるか、衣服が攻撃を受けた（損傷しなくても）時に消失する
  - 時間経過では消失しない
- いい香りの衣服を着ていると、意欲が上昇する
  - ちょうど不潔な衣服の反対のような感じ。

### 天候調整・酸性雨

 - 世界設定オプションから、ヴァリアント版の気候に設定できる
   - ヴァリアント版の気候は、全体的に雨がかなり多く降る
     - [通常の気候（ゲーム開始直後）](https://github.com/roloa/Cataclysm-DDA_variant/blob/variant_jp/doc/weather_vanilla.png)
     - [ヴァリアント版の気候（ゲーム開始直後）](https://github.com/roloa/Cataclysm-DDA_variant/blob/variant_jp/doc/weather_variant.png)
   - ヴァリアント版気候では、霧雨と晴れの境目に虹が出ることがある
     - 虹が出ている時に野外にいると意欲UP
     - 冬季は虹の代わりに細氷 [ Diamond Dust ] になる
- 世界設定オプションから、酸性雨の量を調整できる
  - 基本的には最大の100を想定して調整しているが、デフォルトでは少なめの20にしてある
- バニラからの既存の仕様で、天気には雨の強度と独立して酸の強度が設定されていて、雨が降っている、かつ、酸強度が一定以上だと酸性雨になる
  - バニラでは酸強度が常に0なので酸性雨は降らない
- （バランス調整中）野外にいるすべてのモンスターも酸性雨で少量のダメージを受ける
  - NPCは（たぶん）ダメージを受けない
- 酸性嵐を追加
  -  強い酸強度と雷雨以上の強い雨が重なると、より強力な酸性嵐になる
  - 強い酸強度と吹雪が重なっても、酸性嵐になる
- 酸性雪と小酸性雪を追加
  - 気温が摂氏0度以下だと酸性雨の代わりに酸性雪や小酸性雪が降る 
- 小酸性雨、小酸性雪は低い上限のある微量の苦痛を受ける
  - パワーアーマーヘルメット、傘を構える、レインコート等の雨を防ぐ衣服で完全に防げる
- 酸性雨、酸性雪は高い上限のある苦痛と、全身に少量のダメージを受ける
  - パワーアーマーヘルメット、傘を構えることで完全に防げる
  - レインコート等の雨を防ぐ衣服で90%防げる
- 酸性嵐は、上限のない高い苦痛と、酸性雨の4倍のダメージを受ける
  - パワーアーマーヘルメットで完全に防げる
  - 傘を構えることで90%防げる
  - レインコート等の雨を防ぐ衣服で75%防げる
    - 傘とレインコートを両方使えば掛け算式に97.5%防げる
- 嵐を呼び寄せる効果のアーティファクトは天候を酸性嵐にするように（バニラでは吹雪）


### NPC拡張：車載カーゴからの自動食事

**不安定な試験的機能です！特に以下の状況によって、予想できない不具合が起こることが予想されます(?)ので、ご注意ください**
- 2人以上のNPCが同じ食糧庫から同時に食事をしようとする
- NPCとプレイヤーが同じ食糧庫のアイテムを同時に操作しようとする

- 味方NPCと一緒に車に乗っている時、条件に応じて味方NPCが車載カーゴから勝手に食料を食べる
- 車載パーツの「食糧庫タグ」を作って車載カーゴと同じマスに付けると、NPCは食糧庫として認識する
  - 食糧庫タグはUPS充電ステーションと同様の扱いで、充電ステーションと同じマスには付けられない
- NPCはお腹が空くか喉が渇くと、食糧庫の隣まで歩いて行って、食糧庫から欲しい飲食物を直接食べる
  - 後述の不具合回避のため食糧庫にプレイヤーが隣接している時は手を出さない
  - 食糧庫内のアイテムにプレイヤーとNPCや、2人のNPCが同時に手を出すと予測不可能なまずいことになりそうなので、今のところは注意して使ってください。

### 車両処理省略による負荷の軽減

- 車両の処理を減らすことでクラフトや睡眠のターン処理を軽量化する機能を追加。
- 制御装置のあるマスをeで調べることで車両ごとに有効化できます
  - 積荷処理省略は、毎ターン行われる積荷内のアイテムチェックを1分に一度にする
    - おそらく、ピンの抜かれた手榴弾や電源の入った懐中電灯などのカウントを減らす処理が省略される。
    - アイテムを大量に積んでる場合は少し動作が速くなるかも
  - 自動タレット処理省略は、車載された自動照準のタレットの索敵と射撃の処理を1分に一度だけにする
    - 自動タレットの処理はとても重いのでかなり効果があると思います
- 処理省略設定は車両ごとに適用されるが、セーブされないので、セーブデータをロードしたら毎回オフになります。

### 自動ターン経過調整

- 自動ターン経過がオンになっている時、メニューを開いている間は時間が止まるオプションを追加
  - 副作用で、自動ターン経過がオンのとき通常の行動の動作コストがコマンドの入力にかかった時間によって増加するのも抑制される
- おまけで、自動ターン経過で無駄にした行動コストを表示するオプションも追加


### 近接防衛ボット

- 一般的なタレット製作に必要なスキルと材料＋刃＋ハンマー＋テーザー銃で作れる
- スキルが低くても設置時に敵対はしない
- 射程3以内に入った敵に対して威力10～20の、1/2で打撃か斬撃、あるいは1/7で電撃攻撃をする
- 防御力は一般的なタレットと同等で、HPは約3倍の100HP

### 一括クラフト数拡張

- 世界設定のオプションから、クラフト時の一括製作の上限を変更できます。
  - ゲームの仕様によって**材料の総容量が1000Lを超えると、ゲームがエラーを出して材料が消えます** ので、注意して使ってください

### その他の調整

- 強化車載ヒーターを追加、材料や電力などのコストは2倍ですが、冬でも車内なら全裸でも大丈夫なぐらい暖かくなります
- 待機完了時に経過時間が表示される
- アイテム整理画面の4096個制限の表示を車載カーゴにも表示するように
  - 残念ながら、今のところ、逆に車載カーゴがあるマスの地面のアイテムの数を表示しなくなってしまった。ちゃんとフォーカスしてる場所のアイテム数をちゃんと表示したい
- 軍用探照灯がプルトニウム発電機を必要とせず、さらに友好的な軍用探照灯が、プレイヤーをフォーカスしないように
<!-- - サイドバーのラベル表示の時計を持ってないときの時刻表示を、「真夜中」「夜明け」のような文章による表示から古い型の[_.+ * +._]みたいなグラフィカルなやつに変えられるように。-->
- UPS充電ステーションを車に設置してもタイルが変わらないように（あのでっかい電子チップみたいなやつ）
- 車の位置追跡のメニュー項目が、制御装置があるマスでしか出ないように

