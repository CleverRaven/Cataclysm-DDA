[
  {
    "type": "effect_on_condition",
    "id": "eoc_eggsac_host",
    "//": "Detonates the eggs every once in a while.",
    "recurrence": [ "5 h", "120 h" ],
    "condition": {
      "and": [
        { "math": [ "moon_phase() == 3" ] },
        { "or": [ { "u_has_trait": "EGGSAC_SURVIVABLE" }, { "u_has_trait": "EGGSAC_FATAL" } ] }
      ]
    },
    "deactivate_condition": { "not": { "or": [ { "u_has_trait": "EGGSAC_SURVIVABLE" }, { "u_has_trait": "EGGSAC_FATAL" } ] } },
    "effect": {
      "run_eocs": {
        "id": "eoc_eggsac_mantain_or_remove_switch",
        "condition": { "u_has_trait": "EGGSAC_SURVIVABLE" },
        "effect": { "weighted_list_eocs": [ [ "eggsac_mantain", 10 ], [ "eggsac_remove", { "math": [ "u_val('strength')" ] } ] ] },
        "false_effect": { "weighted_list_eocs": [ [ "eggsac_mantain", 25 ], [ "eggsac_remove", { "math": [ "u_val('strength')" ] } ] ] }
      }
    }
  },
  {
    "type": "effect_on_condition",
    "id": "eggsac_mantain",
    "//": "Spiders erupt from your body! It seems like there are still some eggs in you.",
    "effect": {
      "run_eocs": {
        "id": "eoc_eggsac_survivable_or_fatal",
        "condition": { "u_has_trait": "EGGSAC_SURVIVABLE" },
        "effect": [
          { "npc_cast_spell": { "id": "spider_emergence_weak" } },
          { "u_message": "Spiders erupt from your body!", "type": "bad" }
        ],
        "false_effect": [
          { "npc_cast_spell": { "id": "spider_emergence_strong" } },
          { "u_message": "Spiders erupt from your body!", "type": "bad" }
        ]
      }
    }
  },
  {
    "type": "effect_on_condition",
    "id": "eggsac_remove",
    "//": "Spiders erupt from your body! It seems like those were the last eggs.",
    "effect": {
      "run_eocs": {
        "id": "eoc_eggsac_remove_survivable_or_fatal",
        "condition": { "u_has_trait": "EGGSAC_SURVIVABLE" },
        "effect": [
          { "npc_cast_spell": { "id": "spider_emergence_weak" } },
          { "u_lose_trait": "EGGSAC_SURVIVABLE" },
          { "u_message": "Spiders erupt from your body!", "type": "bad" }
        ],
        "false_effect": [
          { "npc_cast_spell": { "id": "spider_emergence_strong" } },
          { "u_lose_trait": "EGGSAC_FATAL" },
          { "u_message": "Spiders erupt from your body!", "type": "bad" }
        ]
      }
    }
  },
  {
    "type": "effect_on_condition",
    "id": "manifest_destiny_goblin",
    "recurrence": [ "3 days", "5 days" ],
    "condition": { "u_has_trait": "MANIFEST_DESTINY_GOBLIN" },
    "deactivate_condition": { "not": { "u_has_trait": "MANIFEST_DESTINY_GOBLIN" } },
    "effect": [
      { "math": [ "u_vitamin('mutagen_troglobite')", "+=", "750 + rand(100)" ] },
      { "math": [ "u_vitamin('mutagen')", "+=", "750 + rand(100)" ] },
      {
        "run_eocs": {
          "id": "manifest_destiny_goblin_complete",
          "condition": { "u_has_trait": "THRESH_TROGLOBITE" },
          "effect": [ { "u_lose_trait": "MANIFEST_DESTINY_GOBLIN" }, { "u_add_trait": "MANIFESTED_DESTINY_GOBLIN" } ]
        }
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "manifested_destiny_goblin",
    "recurrence": [ "3 days", "5 days" ],
    "condition": { "u_has_trait": "MANIFESTED_DESTINY_GOBLIN" },
    "deactivate_condition": { "u_has_trait": "MANIFESTED_DESTINY_GOBLIN" },
    "effect": [
      { "math": [ "u_vitamin('mutagen_troglobite')", "+=", "1750 + rand(100)" ] },
      { "math": [ "u_vitamin('mutagen')", "+=", "1750 + rand(100)" ] },
      {
        "run_eocs": {
          "id": "destiny_goblin_removal",
          "condition": { "u_has_trait": "THRESH_TROGLOBITE" },
          "effect": [ { "u_lose_trait": "MANIFESTED_DESTINY_GOBLIN" } ]
        }
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "manifest_destiny_spider",
    "recurrence": [ "3 days", "5 days" ],
    "condition": { "u_has_trait": "MANIFEST_DESTINY_SPIDER" },
    "deactivate_condition": { "u_has_trait": "MANIFESTED_DESTINY_SPIDER" },
    "effect": [
      { "math": [ "u_vitamin('mutagen_spider')", "+=", "750 + rand(100)" ] },
      { "math": [ "u_vitamin('mutagen')", "+=", "750 + rand(100)" ] },
      {
        "run_eocs": {
          "id": "manifest_destiny_spider_complete",
          "condition": { "u_has_trait": "THRESH_SPIDER" },
          "effect": [ { "u_lose_trait": "MANIFEST_DESTINY_SPIDER" }, { "u_add_trait": "MANIFESTED_DESTINY_SPIDER" } ]
        }
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "manifested_destiny_spider",
    "recurrence": [ "3 days", "5 days" ],
    "condition": { "u_has_trait": "MANIFESTED_DESTINY_SPIDER" },
    "deactivate_condition": { "not": { "u_has_trait": "MANIFESTED_DESTINY_SPIDER" } },
    "effect": [
      { "math": [ "u_vitamin('mutagen_spider')", "+=", "1750 + rand(100)" ] },
      { "math": [ "u_vitamin('mutagen')", "+=", "1750 + rand(100)" ] },
      {
        "run_eocs": {
          "id": "destiny_goblin_spider",
          "condition": { "u_has_trait": "THRESH_SPIDER" },
          "effect": [ { "u_lose_trait": "MANIFESTED_DESTINY_SPIDER" } ]
        }
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "consume_human_blood",
    "condition": { "u_has_trait": "VAMPIRE" },
    "effect": [ { "math": [ "u_vitamin('human_blood_vitamin')", "+=", "400 + rand(100)" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "eoc_vampire_blood_to_kcal",
    "//": "Check if the vampire is underweight or lower for their size category.  If yes, consume some blood to increase their calories.  Conversion rate of 1 blood vitamin to 5 calories, in 500 calories chunks.",
    "recurrence": [ "1 h", "1 h" ],
    "condition": { "u_has_trait": "BLOOD_DRINKER" },
    "deactivate_condition": { "not": { "u_has_trait": "BLOOD_DRINKER" } },
    "effect": {
      "run_eocs": {
        "id": "eoc_vampire_blood_to_kcal_check_convert",
        "//": "100000 Kcal is within the normal range for a medium-sized character",
        "effect": { 
            "math": [ "u_calories_needed", "=", "100000", "u_size", "=", "u_val('size')" ],
            "switch": { "math": [ "u_size" ] },
            "cases": [
              { "case": 1, "effect": [ { "math": [ "u_calories_needed", "/=", "4" ] } ] },
              { "case": 2, "effect": [ { "math": [ "u_calories_needed", "/=", "2" ] } ] },
              { "case": 3, "effect": [  ] },
              { "case": 4, "effect": [ { "math": [ "u_calories_needed", "*=", "1.5" ] } ] },
              { "case": 5, "effect": [ { "math": [ "u_calories_needed", "*=", "3" ] } ] }
            ],
            "run_eocs":{
              "id": "eoc_vampire_blood_to_kcal_convert",
              "condition": { "math": [ "u_vitamin('human_blood_vitamin')", ">", "0" ] },
              "effect": { 
              "math": [ "u_vitamin('human_blood_vitamin')", "-=", "100", "u_calories()", "+=", "500" ] },
              "u_message": "Some of your stolen blood is consumed by your body, making it a little less gaunt.", "type": "good"
            }
      }
    }
  }
}
]