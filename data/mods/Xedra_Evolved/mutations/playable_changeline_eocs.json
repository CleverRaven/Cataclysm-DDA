[
  {
    "type": "effect_on_condition",
    "id": "EOC_TEST_CHANGELING_COMMONER_INITIAL_CONDITIONS",
    "condition": {
      "and": [
        { "u_has_trait": "FAIR_FOLK_COMMONER_SELECTOR" },
        {
          "not": {
            "u_has_any_trait": [
              "UNKNOWING_CHANGELING_COMMONER_BROWNIE",
              "UNKNOWING_CHANGELING_COMMONER_POOKA",
              "UNKNOWING_CHANGELING_COMMONER_SELKIE",
              "UNKNOWING_CHANGELING_COMMONER_TROW"
            ]
          }
        }
      ]
    },
    "effect": [  ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_TEST_CHANGELING_EFFECTS_REMOVED_BY_COMBAT",
    "condition": {
      "or": [
        { "u_has_effect": "effect_changeling_invisibility" },
        { "u_has_effect": "effect_changeling_right_of_passage" },
        {
          "u_has_any_trait": [
            "CHANGELING_DISGUISE_AS_NATURE_BUSH",
            "CHANGELING_DISGUISE_AS_NATURE_TREE",
            "CHANGELING_DISGUISE_AS_NATURE_POND",
            "CHANGELING_DISGUISE_AS_NATURE_GRASS",
            "CHANGELING_DISGUISE_AS_NATURE_ROCK"
          ]
        }
      ]
    },
    "effect": [  ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_XE_CHANGELING_GRANT_POWER_VITAMIN_RECURRING",
    "recurrence": [ "14 days", "28 days" ],
    "condition": {
      "and": [
        {
          "u_has_any_trait": [
            "UNKNOWING_CHANGELING_NOBLE",
            "UNKNOWING_CHANGELING_COMMONER_BROWNIE",
            "UNKNOWING_CHANGELING_COMMONER_POOKA",
            "UNKNOWING_CHANGELING_COMMONER_SELKIE",
            "UNKNOWING_CHANGELING_COMMONER_TROW"
          ]
        },
        { "math": [ "u_vitamin('changeling_dreams')", "==", "0" ] }
      ]
    },
    "effect": { "math": [ "u_vitamin('changeling_dreams')", "+=", "1" ] }
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_UNKNOWING_CHANGELING_WEARING_IRON_OR_STEEL",
    "eoc_type": "EVENT",
    "required_event": "character_wears_item",
    "condition": {
      "u_has_any_trait": [
        "UNKNOWING_CHANGELING_NOBLE",
        "FAIR_FOLK_COMMONER_SELECTOR",
        "UNKNOWING_CHANGELING_COMMONER_BROWNIE",
        "UNKNOWING_CHANGELING_COMMONER_POOKA",
        "UNKNOWING_CHANGELING_COMMONER_SELKIE",
        "UNKNOWING_CHANGELING_COMMONER_TROW"
      ]
    },
    "effect": [
      { "run_eocs": [ "EOC_UNKNOWING_CHANGELING_WEARING_IRON_FOLLOWUP", "EOC_UNKNOWING_CHANGELING_WEARING_STEEL_FOLLOWUP" ] }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_UNKNOWING_CHANGELING_WIELDING_IRON_OR_STEEL",
    "eoc_type": "EVENT",
    "required_event": "character_wields_item",
    "condition": {
      "u_has_any_trait": [
        "UNKNOWING_CHANGELING_NOBLE",
        "FAIR_FOLK_COMMONER_SELECTOR",
        "UNKNOWING_CHANGELING_COMMONER_BROWNIE",
        "UNKNOWING_CHANGELING_COMMONER_POOKA",
        "UNKNOWING_CHANGELING_COMMONER_SELKIE",
        "UNKNOWING_CHANGELING_COMMONER_TROW"
      ]
    },
    "effect": [
      { "run_eocs": [ "EOC_UNKNOWING_CHANGELING_WEARING_IRON_FOLLOWUP", "EOC_UNKNOWING_CHANGELING_WEARING_STEEL_FOLLOWUP" ] }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_UNKNOWING_CHANGELING_WEARING_IRON_FOLLOWUP",
    "effect": {
      "u_run_inv_eocs": "all",
      "search_data": [ { "material": "iron", "worn_only": true }, { "material": "iron", "wielded_only": true } ],
      "true_eocs": [
        {
          "id": "EOC_UNKNOWING_CHANGELING_WEARING_IRON_RESULT_TRUE",
          "effect": [
            { "u_add_effect": "effect_changeling_wearing_iron", "duration": "PERMANENT" },
            { "queue_eocs": "EOC_UNKNOWING_CHANGELING_WEARING_IRON_FOLLOWUP", "time_in_future": 60 }
          ]
        }
      ],
      "false_eocs": [
        {
          "id": "EOC_UNKNOWING_CHANGELING_WEARING_IRON_RESULT_FALSE",
          "effect": [ { "u_lose_effect": "effect_changeling_wearing_iron" } ]
        }
      ]
    }
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_UNKNOWING_CHANGELING_WEARING_STEEL_FOLLOWUP",
    "effect": {
      "u_run_inv_eocs": "all",
      "search_data": [
        { "material": "steel", "worn_only": true },
        { "material": "lc_steel", "worn_only": true },
        { "material": "mc_steel", "worn_only": true },
        { "material": "hc_steel", "worn_only": true },
        { "material": "ch_steel", "worn_only": true },
        { "material": "lc_steel_chain", "worn_only": true },
        { "material": "mc_steel_chain", "worn_only": true },
        { "material": "hc_steel_chain", "worn_only": true },
        { "material": "ch_steel_chain", "worn_only": true },
        { "material": "steel", "wielded_only": true },
        { "material": "lc_steel", "wielded_only": true },
        { "material": "mc_steel", "wielded_only": true },
        { "material": "hc_steel", "wielded_only": true },
        { "material": "ch_steel", "wielded_only": true },
        { "material": "lc_steel_chain", "wielded_only": true },
        { "material": "mc_steel_chain", "wielded_only": true },
        { "material": "hc_steel_chain", "wielded_only": true },
        { "material": "ch_steel_chain", "wielded_only": true }
      ],
      "true_eocs": [
        {
          "id": "EOC_UNKNOWING_CHANGELING_WEARING_STEEL_RESULT_TRUE",
          "effect": [
            { "u_add_effect": "effect_changeling_wearing_steel", "duration": "PERMANENT" },
            { "queue_eocs": "EOC_UNKNOWING_CHANGELING_WEARING_STEEL_FOLLOWUP", "time_in_future": 60 }
          ],
          "false_effect": [ { "u_lose_effect": "effect_changeling_wearing_steel" } ]
        }
      ],
      "false_eocs": [
        {
          "id": "EOC_UNKNOWING_CHANGELING_WEARING_STEEL_RESULT_FALSE",
          "effect": [ { "u_lose_effect": "effect_changeling_wearing_steel" } ]
        }
      ]
    }
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CHANGELING_EFFECTS_REMOVED_BY_ATTACKING_MONSTERS_MELEE",
    "eoc_type": "EVENT",
    "required_event": "character_melee_attacks_monster",
    "condition": { "test_eoc": "EOC_TEST_CHANGELING_EFFECTS_REMOVED_BY_COMBAT" },
    "effect": [ { "run_eocs": "EOC_CHANGELING_EFFECTS_REMOVED_LOSE_EFFECTS" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CHANGELING_EFFECTS_REMOVED_BY_ATTACKING_CHARACTERS_MELEE",
    "eoc_type": "EVENT",
    "required_event": "character_melee_attacks_character",
    "condition": { "test_eoc": "EOC_TEST_CHANGELING_EFFECTS_REMOVED_BY_COMBAT" },
    "effect": [ { "run_eocs": "EOC_CHANGELING_EFFECTS_REMOVED_LOSE_EFFECTS" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CHANGELING_EFFECTS_REMOVED_BY_ATTACKING_MONSTERS_RANGED",
    "eoc_type": "EVENT",
    "required_event": "character_ranged_attacks_monster",
    "condition": { "test_eoc": "EOC_TEST_CHANGELING_EFFECTS_REMOVED_BY_COMBAT" },
    "effect": [ { "run_eocs": "EOC_CHANGELING_EFFECTS_REMOVED_LOSE_EFFECTS" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CHANGELING_EFFECTS_REMOVED_BY_ATTACKING_CHARACTERS_RANGED",
    "eoc_type": "EVENT",
    "required_event": "character_ranged_attacks_character",
    "condition": { "test_eoc": "EOC_TEST_CHANGELING_EFFECTS_REMOVED_BY_COMBAT" },
    "effect": [ { "run_eocs": "EOC_CHANGELING_EFFECTS_REMOVED_LOSE_EFFECTS" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CHANGELING_EFFECTS_REMOVED_BY_TAKING DAMAGE",
    "eoc_type": "EVENT",
    "required_event": "character_takes_damage",
    "condition": { "test_eoc": "EOC_TEST_CHANGELING_EFFECTS_REMOVED_BY_COMBAT" },
    "effect": [ { "run_eocs": "EOC_CHANGELING_EFFECTS_REMOVED_LOSE_EFFECTS" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CHANGELING_EFFECTS_REMOVED_LOSE_EFFECTS",
    "effect": [
      { "u_lose_effect": "effect_changeling_invisibility" },
      { "u_lose_effect": "effect_changeling_right_of_passage" },
      { "u_lose_trait": "CHANGELING_DISGUISE_AS_NATURE_BUSH" },
      { "u_lose_trait": "CHANGELING_DISGUISE_AS_NATURE_TREE" },
      { "u_lose_trait": "CHANGELING_DISGUISE_AS_NATURE_POND" },
      { "u_lose_trait": "CHANGELING_DISGUISE_AS_NATURE_GRASS" },
      { "u_lose_trait": "CHANGELING_DISGUISE_AS_NATURE_ROCK" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_INCONSPICUOUS_BROWNIE_ATTACKS_MELEE_MONSTER",
    "eoc_type": "EVENT",
    "required_event": "character_melee_attacks_monster",
    "condition": { "or": [ { "u_has_trait": "BROWNIE_EASY_OVERLOOK" }, { "u_has_trait": "BROWNIE_EASY_OVERLOOK2" } ] },
    "effect": [ { "u_add_effect": "effect_brownie_attacked_someone", "duration": 5 } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_INCONSPICUOUS_BROWNIE_ATTACKS_MELEE_CHARACTER",
    "eoc_type": "EVENT",
    "required_event": "character_melee_attacks_character",
    "condition": { "or": [ { "u_has_trait": "BROWNIE_EASY_OVERLOOK" }, { "u_has_trait": "BROWNIE_EASY_OVERLOOK2" } ] },
    "effect": [ { "u_add_effect": "effect_brownie_attacked_someone", "duration": 5 } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_INCONSPICUOUS_BROWNIE_ATTACKS_RANGED_MONSTER",
    "eoc_type": "EVENT",
    "required_event": "character_ranged_attacks_monster",
    "condition": { "or": [ { "u_has_trait": "BROWNIE_EASY_OVERLOOK" }, { "u_has_trait": "BROWNIE_EASY_OVERLOOK2" } ] },
    "effect": [ { "u_add_effect": "effect_brownie_attacked_someone", "duration": 5 } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_INCONSPICUOUS_BROWNIE_ATTACKS_RANGED_CHARACTER",
    "eoc_type": "EVENT",
    "required_event": "character_ranged_attacks_character",
    "condition": { "or": [ { "u_has_trait": "BROWNIE_EASY_OVERLOOK" }, { "u_has_trait": "BROWNIE_EASY_OVERLOOK2" } ] },
    "effect": [ { "u_add_effect": "effect_brownie_attacked_someone", "duration": 5 } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_INCONSPICUOUS_BROWNIE_TAKE_DAMAGE",
    "eoc_type": "EVENT",
    "required_event": "character_takes_damage",
    "condition": { "or": [ { "u_has_trait": "BROWNIE_EASY_OVERLOOK" }, { "u_has_trait": "BROWNIE_EASY_OVERLOOK2" } ] },
    "effect": [ { "u_add_effect": "effect_brownie_attacked_someone", "duration": 5 } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CHANGELING_DISGUISE_AS_NATURE",
    "condition": "u_is_outside",
    "effect": [
      {
        "u_roll_remainder": [
          "CHANGELING_DISGUISE_AS_NATURE_BUSH",
          "CHANGELING_DISGUISE_AS_NATURE_TREE",
          "CHANGELING_DISGUISE_AS_NATURE_POND",
          "CHANGELING_DISGUISE_AS_NATURE_GRASS",
          "CHANGELING_DISGUISE_AS_NATURE_ROCK"
        ],
        "type": "mutation"
      },
      { "u_message": "You wrap yourself up in a glamour.", "type": "good" },
      {
        "queue_eocs": "EOC_CHANGELING_DISGUISE_AS_NATURE_END",
        "time_in_future": [
          { "math": [ "(u_val('intelligence') * 90) + (u_skill('deduction') * 230) + 351" ] },
          { "math": [ "(u_val('intelligence') * 230) + (u_skill('deduction') * 560) + 789" ] }
        ]
      }
    ],
    "false_effect": [ { "u_message": "You need to be among nature to disguise yourself within nature.", "type": "bad" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CHANGELING_DISGUISE_AS_NATURE_END",
    "effect": [
      { "u_lose_trait": "CHANGELING_DISGUISE_AS_NATURE_BUSH" },
      { "u_lose_trait": "CHANGELING_DISGUISE_AS_NATURE_TREE" },
      { "u_lose_trait": "CHANGELING_DISGUISE_AS_NATURE_POND" },
      { "u_lose_trait": "CHANGELING_DISGUISE_AS_NATURE_GRASS" },
      { "u_lose_trait": "CHANGELING_DISGUISE_AS_NATURE_ROCK" },
      { "u_message": "The glamour disguising you fades.", "type": "bad" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CHANGELING_DISGUISE_AS_NATURE_MOVEMENT_ENDS",
    "eoc_type": "EVENT",
    "required_event": "avatar_moves",
    "condition": {
      "u_has_any_trait": [
        "CHANGELING_DISGUISE_AS_NATURE_BUSH",
        "CHANGELING_DISGUISE_AS_NATURE_TREE",
        "CHANGELING_DISGUISE_AS_NATURE_POND",
        "CHANGELING_DISGUISE_AS_NATURE_GRASS",
        "CHANGELING_DISGUISE_AS_NATURE_ROCK"
      ]
    },
    "effect": [ { "run_eocs": "EOC_CHANGELING_DISGUISE_AS_NATURE_END" } ]
  }
]
