[
  {
    "type": "effect_on_condition",
    "id": "EOC_bombastic_perks_initialize",
    "eoc_type": "EVENT",
    "required_event": "game_begin",
    "condition": { "and": [ { "not": { "u_has_trait": "siege_config" } } ] },
    "effect": [
      {
        "u_message": "siege is loaded, configuration menu should appear.  If the mod is properly loaded you should have a new mutation called \"siege_config\".  If you do not, you can enable the mod manually by activating the \"EOC_bombastic_perks_try_configure\" EOC in debug."
      },
      { "run_eocs": ["EOC_seige_configure", "EOC_set_spawnpoint"]  }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_set_spawnpoint",
    "effect": [
      {
        "u_message": "Spawnpoint set!"
      },
      { "u_location_variable": { "u_val": "spawnpoint"}},
      { "u_add_var": "set_coordinates_spawn", "type": "eoc_basic_loc", "context": "eoc_key", "value": "yes" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_siege_counter_point_02",
    "recurrence": "1 day",
     "effect": [
      {"if":{"and":[{"math":["siege_counter", "<=","7"]}, {"math":["distance_01", "<", "100"]}]},
      "then": [{"math":["siege_counter", "++"]},
      {
        "u_message": "siegepoint02: \"<global_val:siege_counter>\""
      },
      { "u_location_variable": { "u_val": "siegepoint02"}},
      { "u_add_var": "set_siegepoint_02", "type": "eoc_basic_loc", "context": "eoc_key", "value": "yes" }
    ],
      "else": [{"math":["siege_counter", "=", "0"]},
      {
        "u_message": "siegepoint01: \"<global_val:siege_counter>\" haven't changed for 7 days, changed now."
      },
      { "u_location_variable": { "u_val": "siegepoint01", "type": "eoc_basic_loc", "context": "eoc_key" }}]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_set_siegepoint_01",
    "recurrence": "1 hour",
    "//": "set siegepoint if u settle down in a new home, or not settle down after 7 days.get_distance_value",
    "effect": [
      {"u_location_variable": { "u_val": "siegepoint02", "type": "eoc_basic_loc", "context": "eoc_key"}},
      {"if":{"not":{"u_has_var":"set_siegepoint_01", "type": "eoc_basic_loc", "context": "eoc_key", "value": "yes"}},
       "then":[{ "u_add_var": "set_siegepoint_01", "type": "eoc_basic_loc", "context": "eoc_key", "value": "yes" }, {"u_message": "siegepoint_01 show!"}]}
      ,
      {
        "math": ["distance_01", "=", "distance(u_eoc_basic_loc_eoc_key_siegepoint01 ,u_eoc_basic_loc_eoc_key_siegepoint02)" ]
      },
      {"if":{"math": ["distance_01", ">", "100" ]}, "then":{"math":["siegepoint02", "=", "siegepoint01"]}},
      {"u_message": "<global_val:distance_02> show!"},
      { "run_eocs": ["EOC_siege_counter_point_02"]}
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_seige_configure",
    "condition": { "and": [ { "not": { "u_has_var": "set_coordinates_spawn", "type": "eoc_basic_loc", "context": "eoc_key", "value": "yes" } } ] },
    "effect": [
      { "open_dialogue": { "topic": "TALK_MENU_WELCOME" } },
      { "queue_eocs": "EOC_TEST_MESSAGE", "time_in_future": "30 seconds" },
      {
        "u_message": "Configuration menu closed, if Bombastic Perks was not properly configured menu will open again in 30 seconds."
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_TEST_MESSAGE",
    "//": "Empty EoC, use it if you need to run EoC with no effect for any reason",
    "//": "设计，1，出生点设置，2，siegepoint01标记为生成怪物的中心位置，3，siegepoint02标记为临时位置，4，判断点1和点2的距离，点1为定居点位置，点2为当前位置（活动范围），如果活动范围超过设定值，则将点1的位置改变为当前位置",
    "effect": [
    {
        "u_message": "Configuration menu closed, NOTHING HAPPEND"
    }
      ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_TEST_CONTROLLER",
    "recurrence": [ "3 hours", "6 hours" ],
    "//": "repeat this, it's a timer of event",
    "global": true,
    "effect": [
      { "u_message": "Welcome to wave <global_val:siege_counter>!", "type": "bad", "popup": false }
    ]
  }
]
