[
  {
    "type": "talk_topic",
    "id": "TALK_PERK_MENU_PSIONICS",
    "dynamic_line": "Psionic Perks:\nLevel <u_val:current_level>.\n<u_val:num_perks> perk points to spend.\nCurrent EXP: <u_val:available_exp>.\nEXP to next level: <u_val:exp_to_perk>.",
    "responses": [
      {
        "condition": { "not": { "u_has_trait": "perk_clear_minded_channeling" } },
        "text": "Gain [<trait_name:perk_clear_minded_channeling>]",
        "effect": [
          { "set_string_var": "<trait_name:perk_clear_minded_channeling>", "target_var": { "context_val": "trait_name" } },
          {
            "set_string_var": "<trait_description:perk_clear_minded_channeling>",
            "target_var": { "context_val": "trait_description" }
          },
          { "set_string_var": "perk_clear_minded_channeling", "target_var": { "context_val": "trait_id" } },
          {
            "set_string_var": "Must know the Basic Concentration proficiency and must not have the Easily Distracted trait.",
            "target_var": { "context_val": "trait_requirement_description" },
            "i18n": true
          },
          {
            "set_condition": "perk_condition",
            "condition": { "and": [ { "u_has_proficiency": "prof_concentration_basic" }, { "not": { "u_has_trait": "CONCENTRATION_BAD" } } ] }
          }
        ],
        "topic": "TALK_PERK_MENU_SELECT"
      },
      {
        "condition": { "not": { "u_has_trait": "perk_in_the_zone" } },
        "text": "Gain [<trait_name:perk_in_the_zone>]",
        "effect": [
          { "set_string_var": "<trait_name:perk_in_the_zone>", "target_var": { "context_val": "trait_name" } },
          {
            "set_string_var": "<trait_description:perk_in_the_zone>",
            "target_var": { "context_val": "trait_description" }
          },
          { "set_string_var": "perk_in_the_zone", "target_var": { "context_val": "trait_id" } },
          {
            "set_string_var": "Must be a psion.",
            "target_var": { "context_val": "trait_requirement_description" },
            "i18n": true
          },
          {
            "set_condition": "perk_condition",
            "condition": {
              "u_has_any_trait": [
                "BIOKINETIC",
                "CLAIRSENTIENT",
                "ELECTROKINETIC",
                "PHOTOKINETIC",
                "PYROKINETIC",
                "TELEKINETIC",
                "TELEPATH",
                "TELEPORTER",
                "VITAKINETIC"
              ]
            }
          }
        ],
        "topic": "TALK_PERK_MENU_SELECT"
      },
      {
        "condition": { "not": { "u_has_trait": "perk_mastery_of_form" } },
        "text": "Gain [<trait_name:perk_mastery_of_form>]",
        "effect": [
          { "set_string_var": "<trait_name:perk_mastery_of_form>", "target_var": { "context_val": "trait_name" } },
          {
            "set_string_var": "<trait_description:perk_mastery_of_form>",
            "target_var": { "context_val": "trait_description" }
          },
          { "set_string_var": "perk_mastery_of_form", "target_var": { "context_val": "trait_id" } },
          {
            "set_string_var": "Must know at least 100 levels of powers between Biokinesis and/or Vitakinesis.",
            "target_var": { "context_val": "trait_requirement_description" },
            "i18n": true
          },
          {
            "set_condition": "perk_condition",
            "condition": { "math": [ "u_spell_level_sum('school': 'BIOKINETIC') + u_spell_level_sum('school': 'VITAKINETIC')", ">=", "100" ] }
          }
        ],
        "topic": "TALK_PERK_MENU_SELECT"
      },
      {
        "condition": { "not": { "u_has_trait": "PYROMANIA" } },
        "text": "Gain [<trait_name:PYROMANIA>]",
        "effect": [
          { "set_string_var": "<trait_name:PYROMANIA>", "target_var": { "context_val": "trait_name" } },
          { "set_string_var": "<trait_description:PYROMANIA>", "target_var": { "context_val": "trait_description" } },
          { "set_string_var": "PYROMANIA", "target_var": { "context_val": "trait_id" } },
          {
            "set_string_var": "Must know at least 30 levels of Pyrokinesis powers.",
            "target_var": { "context_val": "trait_requirement_description" },
            "i18n": true
          },
          {
            "set_condition": "perk_condition",
            "condition": { "math": [ "u_spell_level_sum('school': 'PYROKINETIC')", ">=", "30" ] }
          }
        ],
        "topic": "TALK_PERK_MENU_SELECT"
      },
      { "text": "Back", "topic": "TALK_PERK_MENU_MAIN" },
      { "text": "Settings", "topic": "TALK_PERK_MENU_CONFIG" },
      { "text": "Quit.", "topic": "TALK_DONE" }
    ]
  }
]
