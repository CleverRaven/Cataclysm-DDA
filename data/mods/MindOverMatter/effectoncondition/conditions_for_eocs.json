[
  {
    "type": "effect_on_condition",
    "id": "EOC_CONDITION_SPELLCASTING_FINISH_TRAIT_AND_SCHOOL_LIST",
    "condition": {
      "and": [
        {
          "u_has_any_trait": [
            "BIOKINETIC",
            "CLAIRSENTIENT",
            "ELECTROKINETIC",
            "PHOTOKINETIC",
            "PYROKINETIC",
            "TELEKINETIC",
            "TELEPATH",
            "TELEPORTER",
            "VITAKINETIC"
          ]
        },
        {
          "or": [
            { "compare_string": [ "BIOKINETIC", { "context_val": "school" } ] },
            { "compare_string": [ "CLAIRSENTIENT", { "context_val": "school" } ] },
            { "compare_string": [ "ELECTROKINETIC", { "context_val": "school" } ] },
            { "compare_string": [ "PHOTOKINETIC", { "context_val": "school" } ] },
            { "compare_string": [ "PYROKINETIC", { "context_val": "school" } ] },
            { "compare_string": [ "TELEKINETIC", { "context_val": "school" } ] },
            { "compare_string": [ "TELEPATH", { "context_val": "school" } ] },
            { "compare_string": [ "TELEPORTER", { "context_val": "school" } ] },
            { "compare_string": [ "VITAKINETIC", { "context_val": "school" } ] }
          ]
        }
      ]
    },
    "effect": [  ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CONDITION_CAUGHT_IN_NETHER_WEATHER",
    "condition": {
      "or": [ { "is_weather": "distant_portal_storm" }, { "is_weather": "portal_storm" }, { "is_weather": "close_portal_storm" } ]
    },
    "effect": [  ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CONDITION_NEAR_NETHER_RELATED_LOCATION",
    "condition": {
      "or": [
        { "u_near_om_location": "unvitrified_farm_0", "range": 2 },
        { "u_near_om_location": "unvitrified_farm_1", "range": 2 },
        { "u_near_om_location": "unvitrified_farm_neg_1", "range": 2 },
        { "u_near_om_location": "unvitrified_farm_2", "range": 2 },
        { "u_near_om_location": "vitrified_farm_0", "range": 2 },
        { "u_near_om_location": "vitrified_farm_1", "range": 2 },
        { "u_near_om_location": "vitrified_farm_neg_1", "range": 2 },
        { "u_near_om_location": "vitrified_farm_2", "range": 2 },
        { "u_near_om_location": "microlab_portal_elevator_physics_glass", "range": 2 },
        { "u_near_om_location": "microlab_distorted_hallway", "range": 2 },
        { "u_near_om_location": "microlab_distorted", "range": 2 },
        { "u_near_om_location": "microlab_distorted_edge", "range": 2 },
        { "u_near_om_location": "microlab_portal_elevator_physics_glass", "range": 2 },
        { "u_near_om_location": "corpse_surface", "range": 0 },
        { "u_near_om_location": "corpse_bowels_neck_right", "range": 2 },
        { "u_near_om_location": "corpse_bowels_neck_left", "range": 2 },
        { "u_near_om_location": "corpse_bowels_neck_edge_center", "range": 2 },
        { "u_near_om_location": "corpse_bowels_rcorner", "range": 2 },
        { "u_near_om_location": "corpse_bowels_lcorner", "range": 2 },
        { "u_near_om_location": "corpse_bowels_empty_edge", "range": 2 },
        { "u_near_om_location": "corpse_bowels_mid", "range": 2 },
        { "u_near_om_location": "corpse_tentacle", "range": 2 },
        { "u_near_om_location": "corpse_tentacle_entry", "range": 2 },
        { "u_near_om_location": "corpse_tentacle_surface_entry", "range": 0 },
        { "u_near_om_location": "corpse_bowels_tentacle_edge", "range": 2 },
        { "u_near_om_location": "corpse_bowels_empty_edge", "range": 2 },
        { "u_near_om_location": "corpse_head", "range": 2 },
        { "u_near_om_location": "corpse_brain", "range": 2 },
        { "u_near_om_location": "corpse_under_brain", "range": 2 },
        { "u_near_om_location": "corpse_head_edge", "range": 2 },
        { "u_near_om_location": "corpse_head_fin", "range": 2 },
        { "u_near_om_location": "corpse_head_lcorner", "range": 2 },
        { "u_near_om_location": "corpse_head_rcorner", "range": 2 },
        { "u_near_om_location": "corpse_head_neck_l", "range": 2 },
        { "u_near_om_location": "corpse_head_neck_r", "range": 2 },
        { "u_near_om_location": "corpse_head_neck_center", "range": 2 },
        { "u_near_om_location": "corpse_head_neck_l_decap", "range": 2 },
        { "u_near_om_location": "corpse_head_neck_r", "range": 2 },
        { "u_near_om_location": "corpse_head_neck_r_decap", "range": 2 },
        { "u_near_om_location": "corpse_head_neck_center_decap", "range": 2 },
        { "u_near_om_location": "nether_crystal_field", "range": 1 },
        { "u_near_om_location": "psi_phavian_lab_blockB1", "range": 2 },
        { "u_near_om_location": "psi_phavian_lab_blockD1", "range": 2 },
        { "u_near_om_location": "psi_phavian_lab_blockB3", "range": 2 },
        { "u_near_om_location": "psi_phavian_lab_blockD3", "range": 2 },
        { "u_near_om_location": "psi_phavian_lab_block2B1", "range": 2 },
        { "u_near_om_location": "psi_phavian_lab_block2D1", "range": 2 },
        { "u_near_om_location": "psi_phavian_lab_block2B3", "range": 2 },
        { "u_near_om_location": "psi_phavian_lab_block2D3", "range": 2 },
        { "u_near_om_location": "psi_phavian_lab_block3B1", "range": 2 },
        { "u_near_om_location": "psi_phavian_lab_block3D1", "range": 2 },
        { "u_near_om_location": "psi_phavian_lab_block3B3", "range": 2 },
        { "u_near_om_location": "psi_phavian_lab_block3D3", "range": 2 },
        { "u_near_om_location": "psi_phavian_lab_block4B1", "range": 2 },
        { "u_near_om_location": "psi_phavian_lab_block4D1", "range": 2 },
        { "u_near_om_location": "psi_phavian_lab_block4B3", "range": 2 },
        { "u_near_om_location": "psi_phavian_lab_block4D3", "range": 2 },
        { "u_near_om_location": "psi_phavian_lab_block5B1", "range": 2 },
        { "u_near_om_location": "psi_phavian_lab_block5D1", "range": 2 },
        { "u_near_om_location": "psi_phavian_lab_block5B3", "range": 2 },
        { "u_near_om_location": "psi_phavian_lab_block5D3", "range": 2 },
        { "u_near_om_location": "LIXA_surface_1b_north", "range": 2 },
        { "u_near_om_location": "LIXA_roof_1a_north", "range": 2 },
        { "u_near_om_location": "LIXA_stairshaft_1a_north", "range": 2 },
        { "u_near_om_location": "LIXA_stairshaft_2a_north", "range": 2 },
        { "u_near_om_location": "LIXA_device_2_north", "range": 2 },
        { "u_near_om_location": "LIXA_device_unfolded_noaccess_north", "range": 2 },
        { "u_near_om_location": "LIXA_entry_2_north", "range": 2 },
        { "u_near_om_location": "LIXA_road_north", "range": 2 },
        { "u_near_om_location": "LIXA_road_guard_north", "range": 2 }
      ]
    },
    "effect": [  ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CONDITION_YOU_ARE_IN_NETHER_LOCATION",
    "condition": {
      "or": [
        { "u_near_om_location": "nether_glass_deep", "range": 2 },
        { "u_near_om_location": "nether_glass", "range": 2 },
        { "u_at_om_location": "microlab_portal_elevator_nether_glass" },
        { "u_near_om_location": "void_spider_lair_entrance", "range": 2 },
        { "u_near_om_location": "void_spider_lair_a1", "range": 2 },
        { "u_near_om_location": "void_spider_lair_a2", "range": 2 },
        {
          "and": [ { "math": [ "u_val('pos_z') == 6" ] }, { "not": "u_is_outside" }, { "u_is_on_terrain": "t_floor_warped" } ]
        }
      ]
    },
    "effect": [  ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CONDITION_LIST_OF_POWERS_CANCELLED_BY_COMBAT",
    "condition": {
      "or": [
        { "npc_has_effect": "effect_clair_speed_reader" },
        { "npc_has_effect": "effect_clair_see_auras" },
        { "npc_has_effect": "effect_clair_craft_bonus" },
        { "npc_has_effect": "effect_clair_perfect_shot" },
        { "npc_has_effect": "effect_photokin_light_local" },
        { "npc_has_effect": "effect_pyrokinetic_fire_tool" },
        { "npc_has_item": "pyrokinetic_torch_weld" },
        { "npc_has_effect": "effect_telekinetic_strength" },
        { "npc_has_item": "telekin_lifting_jack_1" },
        { "npc_has_item": "telekin_lifting_jack_2" },
        { "npc_has_item": "telekin_lifting_jack_3" },
        { "npc_has_item": "telekin_lifting_jack_4" },
        { "npc_has_item": "telekin_lifting_jack_5" },
        { "npc_has_item": "telekin_lifting_jack_6" },
        { "npc_has_item": "telekin_lifting_jack_7" },
        { "npc_has_item": "telekin_lifting_jack_8" },
        { "npc_has_item": "telekin_lifting_jack_9" },
        { "npc_has_item": "telekin_lifting_jack_10" },
        { "npc_has_item": "telekin_lifting_jack_11" },
        { "npc_has_item": "telekin_lifting_jack_12" },
        { "npc_has_item": "telekin_lifting_jack_13" },
        { "npc_has_item": "telekin_lifting_jack_14" },
        { "npc_has_item": "telekin_lifting_jack_15" },
        { "npc_has_item": "telekin_lifting_jack_16" },
        { "npc_has_item": "telekin_lifting_jack_17" },
        { "npc_has_item": "telekin_lifting_jack_18" },
        { "npc_has_item": "telekin_lifting_jack_19" },
        { "npc_has_item": "telekin_lifting_jack_20" },
        { "npc_has_effect": "effect_telekinetic_levitation" },
        { "npc_has_effect": "effect_telepathic_learning_bonus" }
      ]
    },
    "effect": [  ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CONDITION_AWAKENING_X_IN_Y_CHANCE",
    "condition": { "x_in_y_chance": { "x": { "math": [ "100 - u_awakening_reducer" ] }, "y": 100 } },
    "effect": [  ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_PORTAL_STORM_CONDITION_FLAG_PORTAL_PROOF",
    "condition": {
      "and": [
        { "not": { "u_has_worn_with_flag": "PORTAL_PROOF" } },
        {
          "not": {
            "and": [
              { "u_has_effect": "effect_telepathic_psi_armor" },
              {
                "math": [
                  "u_spell_level('telepathic_shield')",
                  ">=",
                  "(u_vitamin('vitamin_psionic_drain') / 10) + (max(u_school_level('BIOKINETIC'), u_school_level('CLAIRSENTIENT'), u_school_level('ELECTROKINETIC'), u_school_level('PHOTOKINETIC'), u_school_level('PYROKINETIC'), u_school_level('TELEPATH'), u_school_level('TELEKINETIC'), u_school_level('TELEPORTER'), u_school_level('VITAKINETIC')) / 3) + (u_awakening_countup / 3)"
                ]
              }
            ]
          }
        }
      ]
    },
    "effect": [  ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CONDITION_ODDS_OF_RANDOM_NO_PREREQ_POWER_INSIGHT",
    "condition": { "x_in_y_chance": { "x": 1, "y": 3 } },
    "effect": [  ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CONDITION_ODDS_OF_RANDOM_TIER_ONE_POWER_INSIGHT",
    "condition": { "x_in_y_chance": { "x": 1, "y": 20 } },
    "effect": [  ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CONDITION_ODDS_OF_RANDOM_TIER_TWO_POWER_INSIGHT",
    "condition": { "x_in_y_chance": { "x": 1, "y": 40 } },
    "effect": [  ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CONDITION_ODDS_OF_RANDOM_TIER_THREE_POWER_INSIGHT",
    "condition": { "x_in_y_chance": { "x": 1, "y": 80 } },
    "effect": [  ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CONDITION_HAS_MIND",
    "//": "we will assume that all npcs have mind, but in case it won't hold for some npc, potential fix would be making it `and[ npc_is_npc, not:{npc_has_flag:foo} ]`",
    "condition": {
      "and": [
        {
          "or": [
            { "and": [ { "not": { "npc_has_species": "PSI_NULL" } }, { "npc_has_flag": "HAS_MIND" } ] },
            {
              "and": [
                { "not": { "npc_has_species": "PSI_NULL" } },
                { "not": { "npc_has_species": "ZOMBIE" } },
                { "npc_has_flag": "HUMAN" }
              ]
            },
            "npc_is_npc"
          ]
        },
        { "not": { "npc_has_effect": "eff_monster_immune_to_telepathy" } },
        { "not": { "npc_has_flag": "TEEP_IMMUNE" } }
      ]
    },
    "effect": [  ]
  }
]
