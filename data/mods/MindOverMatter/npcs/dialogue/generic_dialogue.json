[
  {
    "id": "TALK_STOLE_ITEM",
    "type": "talk_topic",
    "responses": [
      {
        "text": "[Telepathy Check] What are you talking about?  This is mine.",
        "condition": { "u_has_trait": "TELEPATH" },
        "switch": true,
        "trial": {
          "type": "CONDITION",
          "condition": {
            "roll_contested": { "math": [ "u_val('spell_level', 'school: TELEPATH')" ] },
            "difficulty": { "math": [ "n_val('intelligence')" ] },
            "die_size": 5
          }
        },
        "success": { "topic": "TALK_TELEPATHY_ALLOW_KEEP_ITEM" },
        "failure": { "topic": "TALK_DISALLOW_KEEP_ITEM" }
      }
    ]
  },
  {
    "id": "TALK_TELEPATHY_ALLOW_KEEP_ITEM",
    "type": "talk_topic",
    "dynamic_line": [
      "Oh, I…I don't know what I was thinking. I…sorry.",
      "It is?  Oh, it…it is.  That's right.",
      "I…I thought that…never mind.",
      "But you…no, I…I just…"
    ],
    "responses": [ { "text": "Thanks.", "topic": "TALK_DONE", "effect": "remove_stolen_status" } ]
  },
  {
    "id": [ "TALK_MUG", "TALK_STRANGER_AGGRESSIVE" ],
    "type": "talk_topic",
    "responses": [
      {
        "text": "[Telekinesis Check] *Try to rip their weapon out of their hands*.",
        "condition": { "u_has_trait": "TELEKINETIC" },
        "switch": true,
        "trial": {
          "type": "CONDITION",
          "condition": {
            "roll_contested": { "math": [ "u_val('spell_level', 'school: TELEKINETIC')" ] },
            "difficulty": { "math": [ "n_val('strength')" ] },
            "die_size": 5
          }
        },
        "success": { "topic": "TALK_MUG_TELEKINESIS_USED", "effect": "drop_weapon" },
        "failure": { "topic": "TALK_DONE", "effect": [ "hostile", { "u_message": "Your telekinesis attempt failed!", "type": "bad" } ] }
      }
    ]
  },
  {
    "id": "TALK_MUG_TELEKINESIS_USED",
    "type": "talk_topic",
    "dynamic_line": {
      "npc_male": [
        "*'s weapon flies out of his hands.\n\n\"<swear> <name_b>!  You some kind of witch?",
        "*'s weapon flies out of his hands and he lets out a startled yelp."
      ],
      "no": [
        "*'s weapon flies out of her hands.\n\n\"<swear> <name_b>!  You some kind of witch?",
        "*'s weapon flies out of her hands and she lets out a startled yelp."
      ]
    },
    "responses": [
      {
        "text": "Get out of here before I do worse.",
        "topic": "TALK_DONE",
        "effect": "flee",
        "opinion": { "trust": -1, "fear": 2, "anger": -2 }
      }
    ]
  },
  {
    "id": [ "TALK_MUG", "TALK_STRANGER_AGGRESSIVE" ],
    "type": "talk_topic",
    "responses": [
      {
        "text": "[Telepathy Check] You don't want to hurt me.",
        "condition": { "u_has_trait": "TELEPATH" },
        "switch": true,
        "trial": {
          "type": "CONDITION",
          "condition": {
            "roll_contested": { "math": [ "u_val('spell_level', 'school: TELEPATH')" ] },
            "difficulty": { "math": [ "n_val('intelligence')" ] },
            "die_size": 5
          }
        },
        "success": { "topic": "TALK_STRANGER_NEUTRAL", "effect": "stranger_neutral", "opinion": { "trust": 3, "fear": -1 } },
        "failure": { "topic": "TALK_DONE", "effect": [ "hostile", { "u_message": "Your telepathy attempt failed!", "type": "bad" } ] }
      }
    ]
  },
  {
    "id": "TALK_STRANGER_SCARED",
    "type": "talk_topic",
    "responses": [
      {
        "text": "[Telepathy Check] I'm not going to hurt you.",
        "condition": { "u_has_trait": "TELEPATH" },
        "switch": true,
        "trial": {
          "type": "CONDITION",
          "condition": {
            "roll_contested": { "math": [ "u_val('spell_level', 'school: TELEPATH')" ] },
            "difficulty": { "math": [ "n_val('intelligence')" ] },
            "die_size": 5
          }
        },
        "success": { "topic": "TALK_STRANGER_NEUTRAL", "effect": "stranger_neutral", "opinion": { "trust": 3, "fear": -1 } },
        "failure": { "topic": "TALK_DONE", "effect": [ "flee", { "u_message": "Your telepathy attempt failed!", "type": "bad" } ] }
      }
    ]
  },
  {
    "id": [ "TALK_MUG", "TALK_STRANGER_AGGRESSIVE" ],
    "type": "talk_topic",
    "responses": [
      {
        "text": "[Sensory Deprivation Check] *Shut off <npcname>'s senses*.",
        "condition": { "math": [ "u_val('spell_level', 'spell: telepathic_confusion')", ">=", "1" ] },
        "switch": true,
        "trial": {
          "type": "CONDITION",
          "condition": {
            "roll_contested": { "math": [ "u_val('spell_level', 'spell: telepathic_confusion')" ] },
            "difficulty": { "math": [ "n_val('perception')" ] },
            "die_size": 10
          }
        },
        "success": {
          "topic": "TALK_DONE",
          "effect": [
            "hostile",
            { "npc_add_effect": "psi_blind", "duration": "30 s" },
            { "npc_add_effect": "psi_deaf", "duration": "30 s" }
          ]
        },
        "failure": {
          "topic": "TALK_DONE",
          "effect": [ "hostile", { "u_message": "You failed to affect <npcname>'s senses!", "type": "bad" } ]
        }
      }
    ]
  },
  {
    "id": [ "TALK_MUG", "TALK_STRANGER_AGGRESSIVE" ],
    "type": "talk_topic",
    "responses": [
      {
        "text": "[Synaptic Overload Check] *Attack <npcname>'s mind*.",
        "condition": { "math": [ "u_val('spell_level', 'spell: telepathic_blast')", ">=", "1" ] },
        "switch": true,
        "trial": {
          "type": "CONDITION",
          "condition": {
            "roll_contested": { "math": [ "u_val('spell_level', 'spell: telepathic_blast')" ] },
            "difficulty": { "math": [ "n_val('intelligence')" ] },
            "die_size": 10
          }
        },
        "success": {
          "topic": "TALK_DONE",
          "effect": [
            "hostile",
            {
              "npc_set_hp": { "math": [ "(80 - (6 * (u_val('spell_level', 'spell: telepathic_blast')))" ] },
              "target_part": "head"
            },
            { "npc_add_effect": "stunned", "duration": "1 s" }
          ]
        },
        "failure": {
          "topic": "TALK_DONE",
          "effect": [ "hostile", { "u_message": "<npcname> repelled your attack on <mypronoun> mind!", "type": "bad" } ]
        }
      }
    ]
  }
]
