[
  {
    "type": "effect_on_condition",
    "id": "EOC_deathconfirmed",
    "//": "Dying on the island is now permanent if you have not completed the first quest.",
    "condition": { "not": { "u_has_trait": "awayfromhome" } },
    "effect": [ { "run_eocs": "EOC_death_on_island" } ],
    "false_effect": [
      "u_prevent_death",
      { "u_add_effect": "incorporeal", "duration": 1 },
      { "u_add_effect": "downed", "duration": 1 },
      { "run_eocs": [ "EOC_death_heal" ] },
      { "u_spawn_item": "corpse_painful" },
      { "math": [ "raidslost++" ] },
      { "run_eocs": "EOC_return_OM_teleport", "time_in_future": "1 s" },
      {
        "u_message": "You feel the icy grip of death begin to take you, and the world whirls and rushes past.  Reality bends and at the peak of your last mortal moment, something snags you and hauls you through space and time.  Your mind has been preserved, at cost, and your body is not far behind.",
        "popup": true
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_death_on_island",
    "//": "Dying on the island is now permanent if you have not completed the first quest, so that you can't cheat cold and dehydration issues away early game by dying.",
    "condition": { "math": [ "islandrank >= 0" ] },
    "effect": [
      "u_prevent_death",
      { "u_add_effect": "downed", "duration": 1 },
      { "u_add_effect": "incorporeal", "duration": 500 },
      { "run_eocs": [ "EOC_death_heal" ] },
      {
        "u_message": "You died at home?  What's the matter with you?  Stop this.  You are restored.  The powers that be have made you temporarily incorporeal, in case you were stuck in a deadly loop.",
        "popup": true
      }
    ],
    "false_effect": [
      {
        "u_message": "Seeing you die so early makes the island realize the error in placing trust in you.  It will find someone else.",
        "popup": false
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_voidblock_init",
    "eoc_type": "EVENT",
    "required_event": "game_start",
    "effect": [
      { "math": [ "sky_water_quest_done = 0" ] },
      { "run_eocs": "EOC_voidblock_time_passed", "time_in_future": "48 hours" },
      { "assign_mission": "SKYISLAND_UPGRADE_raidlength0" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_voidblock_time_passed",
    "effect": [
      { "math": [ "islandrank  += 1" ] },
      {
        "u_message": "By surviving 48 hours, you have shown the island that you have some promise.  Once you have also made 6 units of clean water, you can go on expeditions.",
        "type": "mixed"
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_set_starting_islandrank",
    "//": "Makes it easier for voidblock to overwrite starting island rank",
    "effect": { "math": [ "islandrank = -2" ] }
  }
]
