[
  {
    "type": "npc",
    "id": "ranch_doctor",
    "//": "Provides advanced medical attention.",
    "name_suffix": "Doctor",
    "class": "NC_DOCTOR",
    "attitude": 0,
    "mission": 7,
    "chat": "TALK_RANCH_DOCTOR",
    "faction": "tacoma_commune"
  },
  {
    "type": "talk_topic",
    "id": "TALK_RANCH_DOCTOR",
    "dynamic_line": {
      "u_has_var": "doctor_provides_aid",
      "type": "dialogue",
      "context": "tacoma_ranch",
      "value": "yes",
      "yes": "How can I help you today?",
      "no": "I'm sorry, I don't have time to see you at the moment."
    },
    "responses": [
      {
        "text": "Is there anything else I can help with?",
        "topic": "TALK_MISSION_LIST",
        "condition": {
          "and": [ { "u_has_var": "doctor_completed_supplies", "type": "mission", "context": "tacoma_ranch", "value": "yes" } ]
        }
      },
      {
        "text": "Maybe I could help you with something?",
        "topic": "TALK_RANCH_DOCTOR_SUPPLIES",
        "condition": {
          "and": [
            { "not": { "u_has_var": "doctor_completed_supplies", "type": "mission", "context": "tacoma_ranch", "value": "yes" } },
            { "not": { "u_has_mission": "MISSION_RANCH_DOCTOR_SUPPLIES" } }
          ]
        },
        "effect": [
          { "add_mission": "MISSION_RANCH_DOCTOR_SUPPLIES" },
          { "u_add_var": "doctor_completed_supplies", "type": "mission", "context": "tacoma_ranch", "value": "no" }
        ]
      },
      {
        "text": "I have the supplies you asked for.",
        "topic": "TALK_RANCH_DOCTOR",
        "condition": {
          "and": [
            { "u_has_items": { "item": "book_binder", "count": 10 } },
            { "u_has_items": { "item": "paper", "count": 500 } },
            { "u_has_mission": "MISSION_RANCH_DOCTOR_SUPPLIES" }
          ]
        },
        "effect": [ "mission_success", "clear_mission" ]
      },
      {
        "text": "I have the anesthetic you asked for.",
        "topic": "MISSION_RANCH_DOCTOR_MEDICAL_ANESTHETIC_DELIVERED",
        "condition": {
          "and": [
            { "u_has_mission": "MISSION_RANCH_DOCTOR_MEDICAL_ANESTHETIC" },
            {
              "not": { "u_has_var": "doctor_anesthetic_delivered", "type": "mission", "context": "tacoma_ranch", "value": "yes" }
            },
            { "u_has_items": { "item": "anesthetic", "count": 3000 } }
          ]
        },
        "effect": [
          { "u_sell_item": "anesthetic", "count": 3000 },
          { "npc_consume_item": "anesthetic", "count": 3000 },
          { "u_add_var": "doctor_anesthetic_delivered", "type": "mission", "context": "tacoma_ranch", "value": "yes" }
        ]
      },
      { "text": "Could you help me with some bionics?", "topic": "TALK_RANCH_DOCTOR_BIONICS" },
      { "text": "I could use your medical assistance.", "topic": "TALK_RANCH_DOCTOR_AID" },
      { "text": "…", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": "TALK_RANCH_DOCTOR_AID",
    "type": "talk_topic",
    "dynamic_line": {
      "u_has_var": "doctor_provides_aid",
      "type": "dialogue",
      "context": "tacoma_ranch",
      "value": "yes",
      "yes": {
        "npc_has_effect": "currently_busy",
        "yes": "I have other patients to attend to.  Come back later.",
        "no": "What can I help you with?"
      },
      "no": "I can't right now, I have other matters to attend to."
    },
    "responses": [
      {
        "text": "[$200, 30m] I need you to patch me up.",
        "topic": "TALK_RANCH_DOCTOR_AID_DONE",
        "effect": [ "give_aid", { "u_spend_cash": 20000 } ],
        "condition": {
          "and": [
            { "npc_service": true },
            { "u_has_var": "doctor_provides_aid", "type": "dialogue", "context": "tacoma_ranch", "value": "yes" }
          ]
        }
      },
      {
        "text": "[$500, 1h] I need you to patch my friends up.",
        "topic": "TALK_RANCH_DOCTOR_AID_DONE",
        "effect": [ "give_all_aid", { "u_spend_cash": 50000 } ],
        "condition": {
          "and": [
            { "npc_service": true },
            { "u_has_var": "doctor_provides_aid", "type": "dialogue", "context": "tacoma_ranch", "value": "yes" }
          ]
        }
      },
      { "text": "Never mind.", "topic": "TALK_NONE" },
      { "text": "I've got to go…", "topic": "TALK_DONE" }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_RANCH_DOCTOR_AID_DONE",
    "dynamic_line": "Take it easy now.  Wouldn't want you coming back here too soon.",
    "responses": [ { "text": "…", "topic": "TALK_DONE" } ]
  },
  {
    "id": "TALK_RANCH_DOCTOR_BIONICS",
    "type": "talk_topic",
    "dynamic_line": {
      "u_has_var": "doctor_provides_bionics",
      "type": "dialogue",
      "context": "tacoma_ranch",
      "value": "yes",
      "yes": "What can I help you with?",
      "no": "We don't have the medical equipment to do that right now."
    },
    "responses": [
      {
        "text": "I was wondering if you could install a cybernetic implant…",
        "topic": "TALK_DONE",
        "effect": "bionic_install",
        "condition": {
          "and": [
            { "npc_service": true },
            { "u_has_var": "doctor_provides_bionics", "type": "dialogue", "context": "tacoma_ranch", "value": "yes" }
          ]
        }
      },
      {
        "text": "I need help removing an implant…",
        "topic": "TALK_DONE",
        "effect": "bionic_remove",
        "condition": {
          "and": [
            { "npc_service": true },
            { "u_has_var": "doctor_provides_bionics", "type": "dialogue", "context": "tacoma_ranch", "value": "yes" }
          ]
        }
      },
      { "text": "Never mind.", "topic": "TALK_NONE" },
      { "text": "I've got to go…", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": "TALK_RANCH_DOCTOR_SUPPLIES",
    "type": "talk_topic",
    "dynamic_line": "There's too much to keep track of right now and nobody has any kind of office supplies around here.  I need to be able to keep track of medical records and keep them organized so that I can focus on helping people.  Ten binders and a ream of paper should get us started.",
    "responses": [
      {
        "text": "I'll see what I can find.",
        "topic": "TALK_RANCH_DOCTOR",
        "effect": [ { "u_add_var": "doctor_completed_supplies", "type": "mission", "context": "tacoma_ranch", "value": "no" } ]
      },
      { "text": "Never mind.", "topic": "TALK_NONE" },
      { "text": "I've got to go…", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": "MISSION_RANCH_DOCTOR_MEDICAL_ANESTHETIC_DELIVERED",
    "type": "talk_topic",
    "dynamic_line": "Thanks, this will help a lot.",
    "responses": [ { "text": "Glad to help.", "topic": "TALK_NONE" }, { "text": "I've got to go…", "topic": "TALK_DONE" } ]
  },
  {
    "id": "MISSION_RANCH_DOCTOR_SUPPLIES",
    "type": "mission_definition",
    "name": { "str": "Collect Office Supplies" },
    "description": "The doctor needs office supplies to keep track of medical records.  Bring them 10 Book binders and 500 paper",
    "goal": "MGOAL_CONDITION",
    "goal_condition": { "npc_has_var": "-", "type": "-", "context": "-", "value": "-" },
    "difficulty": 1,
    "value": 50000,
    "origins": [ "ORIGIN_SECONDARY" ],
    "followup": "MISSION_RANCH_DOCTOR_MEDICAL_GLOVES",
    "dialogue": {
      "describe": "-",
      "offer": "-",
      "accepted": "-",
      "rejected": "-",
      "advice": "-",
      "inquire": "-",
      "success": "-",
      "success_lie": "-",
      "failure": "-"
    },
    "end": {
      "update_mapgen": [
        {
          "om_terrain": "ranch_camp_59",
          "set": [
            { "square": "furniture", "id": "f_filing_cabinet", "x": 5, "y": 0, "x2": 8, "y2": 0 },
            { "square": "furniture", "id": "f_filing_cabinet", "x": 5, "y": 2, "x2": 8, "y2": 2 }
          ],
          "place_items": [
            { "item": "ranch_doctor_filing_cabinets", "x": [ 5, 8 ], "chance": 100, "y": 0, "repeat": 5 },
            { "item": "ranch_doctor_filing_cabinets", "x": [ 5, 8 ], "chance": 100, "y": 2, "repeat": 5 }
          ]
        }
      ],
      "effect": [
        { "u_sell_item": "book_binder", "count": 10 },
        { "npc_consume_item": "book_binder", "count": 10 },
        { "u_sell_item": "paper", "count": 500 },
        { "npc_consume_item": "paper", "count": 500 },
        { "u_add_var": "doctor_completed_supplies", "type": "mission", "context": "tacoma_ranch", "value": "yes" }
      ]
    }
  },
  {
    "id": "MISSION_RANCH_DOCTOR_MEDICAL_GLOVES",
    "type": "mission_definition",
    "name": { "str": "Find 10 Pairs of Medical Gloves" },
    "description": "Bring the doctor 10 pairs of medical gloves.",
    "goal": "MGOAL_FIND_ITEM",
    "difficulty": 5,
    "value": 50000,
    "item": "gloves_medical",
    "count": 10,
    "origins": [ "ORIGIN_SECONDARY" ],
    "followup": "MISSION_RANCH_DOCTOR_MEDICAL_ANESTHETIC",
    "dialogue": {
      "describe": "We need help…",
      "offer": "If we need to perform any serious surgery, I'm going to need some more medical gloves to help prevent infections.  Can you bring me 10 pairs?",
      "accepted": "I'm counting on you.",
      "rejected": "Come back when you get a chance.  We need skilled survivors.",
      "advice": "Hospitals or clinics might have a few sitting around.",
      "inquire": "Do you have the medical gloves?",
      "success": "Thank you for your assistance.",
      "success_lie": "What good does this do us?",
      "failure": "It was a lost cause anyways…"
    },
    "end": { "effect": [ { "u_add_var": "doctor_provides_aid", "type": "dialogue", "context": "tacoma_ranch", "value": "yes" } ] }
  },
  {
    "id": "MISSION_RANCH_DOCTOR_MEDICAL_ANESTHETIC",
    "type": "mission_definition",
    "name": { "str": "Anesthetic for the Doctor" },
    "description": "Bring the doctor 3000 units of anesthetic.  Ask around the commune for assistance in building an anesthetic machine.",
    "goal": "MGOAL_CONDITION",
    "goal_condition": {
      "and": [
        { "u_has_var": "doctor_anesthetic_delivered", "type": "mission", "context": "tacoma_ranch", "value": "yes" },
        {
          "u_has_var": "doctor_anesthetic_scavengers_helped",
          "type": "mission",
          "context": "tacoma_ranch",
          "value": "yes"
        },
        {
          "u_has_var": "doctor_anesthetic_scrappers_helped",
          "type": "mission",
          "context": "tacoma_ranch",
          "value": "yes"
        }
      ]
    },
    "difficulty": 5,
    "value": 50000,
    "item": "anesthetic",
    "count": 3000,
    "origins": [ "ORIGIN_SECONDARY" ],
    "followup": "MISSION_NULL",
    "dialogue": {
      "describe": "We need help…",
      "offer": "We only have basic painkillers right now.  For longer surgeries, we're going to need some anesthetic to prevent pain.  Can you bring me 3000 units to start?  We're also going to need an anesthetic machine to deliver it.  Maybe some people around the commune can help with that?",
      "accepted": "I'm counting on you.",
      "rejected": "Come back when you get a chance.  We need skilled survivors.",
      "advice": "Hospitals or clinics might have some.  Labs could have some as well.",
      "inquire": "Any progress on getting some anesthetic or parts?  Make sure to take the anesthetic out of a kit first as well.",
      "success": "The scavengers found more medical equipment than I expected and with the help from the scrappers, I've been able to get most of it up and running.  I should be able to perform more operations now and could even help with some bionics if you have any.",
      "success_lie": "What good does this do us?",
      "failure": "It was a lost cause anyways…"
    },
    "end": {
      "update_mapgen": [ { "om_terrain": "ranch_camp_50", "set": [ { "point": "furniture", "id": "f_anesthetic", "x": 19, "y": 19 } ] } ],
      "effect": { "u_add_var": "doctor_provides_bionics", "type": "dialogue", "context": "tacoma_ranch", "value": "yes" }
    }
  }
]
