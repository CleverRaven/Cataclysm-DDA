[
  {
    "type": "npc",
    "id": "balthazar",
    "name_unique": "balthazar",
    "class": "NC_BALTHAZAR",
    "attitude": 0,
    "mission": 0,
    "chat": "TALK_BALTHAZAR_INTERCOM",
    "faction": "balthazar_fac",
    "mission_offered": "MISSION_GET_SOLAR_PANELS_BALTHAZAR"
  },
  {
    "type": "npc_class",
    "id": "NC_BALTHAZAR",
    "name": { "str": "bunker voice" },
    "job_description": "Locked in a bunker.",
    "common": false,
    "carry_override": "EMPTY_GROUP",
    "worn_override": "EMPTY_GROUP",
    "weapon_override": "EMPTY_GROUP"
  },
  {
    "id": "TALK_BALTHAZAR_INTERCOM",
    "type": "talk_topic",
    "dynamic_line": {
      "compare_string": [ "yes", { "u_val": "dialogue_balthazar_u_discovered_balthazar_fac" } ],
      "yes": [
        "As soon as you walk up to the intercom it turns on",
        "Once you get close enough, the intercom crackles on",
        "The wiring on this intercom is out for anyone to see",
        "You hear Some static come through the tinny speaker"
      ],
      "no": "After some brief static you hear a voice coming through with a crackle and a pop \"..llo?  Hello?  Is someone there?\""
    },
    "speaker_effect": {
      "effect": { "u_add_var": "dialogue_balthazar_u_discovered_balthazar_fac", "value": "yes" },
      "sentinel": "discovered_balthazar"
    },
    "responses": [
      {
        "text": "I'm here.",
        "condition": { "compare_string": [ "yes", { "u_val": "dialogue_balthazar_u_discovered_balthazar_fac" } ] },
        "topic": "TALK_BALTHAZAR_INTERCOM_MAIN"
      },
      {
        "text": "[Clear your throat.]",
        "condition": { "compare_string": [ "yes", { "u_val": "dialogue_balthazar_u_discovered_balthazar_fac" } ] },
        "topic": "TALK_BALTHAZAR_INTERCOM_MAIN"
      },
      {
        "text": "I'm here.",
        "condition": { "not": { "compare_string": [ "yes", { "u_val": "dialogue_balthazar_u_discovered_balthazar_fac" } ] } },
        "trial": { "type": "CONDITION", "condition": { "math": [ "balthazar_power <= 150" ] } },
        "success": { "topic": "TALK_BALTHAZAR_MEET_WEAK" },
        "failure": { "topic": "TALK_BALTHAZAR_MEET_STRONG" }
      },
      {
        "text": "Who is this?",
        "condition": { "not": { "compare_string": [ "yes", { "u_val": "dialogue_balthazar_u_discovered_balthazar_fac" } ] } },
        "trial": { "type": "CONDITION", "condition": { "math": [ "balthazar_power <= 150" ] } },
        "success": { "topic": "TALK_BALTHAZAR_MEET_WEAK" },
        "failure": { "topic": "TALK_BALTHAZAR_MEET_STRONG" }
      },
      { "text": "Walk away.", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": "TALK_BALTHAZAR_INTERCOM_MAIN",
    "//": "Main dialogue that everything loops back to",
    "type": "talk_topic",
    "dynamic_line": [ "Yes?", "Hmm?", "What is it?", "Any luck?" ],
    "responses": [
      {
        "text": "About the mission...",
        "topic": "TALK_MISSION_INQUIRE",
        "condition": { "and": [ "has_assigned_mission", { "not": { "u_has_mission": "MISSION_GET_SOLAR_PANELS_BALTHAZAR" } } ] }
      },
      {
        "text": "About the missions...",
        "topic": "TALK_MISSION_LIST_ASSIGNED",
        "condition": "has_many_assigned_missions"
      },
      {
        "text": "Here are the solar panels",
        "topic": "TALK_BALTHAZAR_SOLAR_PANEL",
        "condition": { "u_has_mission": "MISSION_GET_SOLAR_PANELS_BALTHAZAR" }
      },
      { "text": "Walk away.", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": "TALK_BALTHAZAR_SOLAR_PANEL",
    "type": "talk_topic",
    "dynamic_line": "You brought solar panels?!",
    "responses": [
      {
        "text": "Here you go. (Deliver 12 solar panels)",
        "condition": { "u_has_items": { "item": "solar_panel", "count": 12 } },
        "trial": { "type": "CONDITION", "condition": { "math": "u_negotiated_balthazar_solar >= 1" } },
        "succes": { "topic": "TALK_BALTHAZAR_SOLAR_PANEL_REWARD_MEDIUM" },
        "failure": { "topic": "TALK_BALTHAZAR_SOLAR_PANEL_REWARD_SMALL" }
      },
      {
        "text": "I gathered some extra, here you go. (Deliver 20 solar panels)",
        "condition": { "u_has_items": { "item": "solar_panel", "count": 20 } },
        "trial": { "type": "CONDITION", "condition": { "math": "u_negotiated_balthazar_solar >= 1" } },
        "succes": { "topic": "TALK_BALTHAZAR_SOLAR_PANEL_REWARD_BIG" },
        "failure": { "topic": "TALK_BALTHAZAR_SOLAR_PANEL_REWARD_MEDIUM" }
      },
      { "text": "On second thought, I need a bit longer.", "topic": "TALK_BALTHAZAR_INTERCOM_MAIN" },
      { "text": "Walk away.", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": "TALK_BALTHAZAR_SOLAR_PANEL_REWARD_SMALL",
    "//": "Small reward means player is slightly more cost efficient (useful) than someone who wants bigger rewards",
    "type": "talk_topic",
    "dynamic_line": "Thank you so much, I'll send some bullets and a gun over.",
    "speaker_effect": {
      "effect": [
        { "math": "u_balthazar_small_rewards += 1" },
        { "finish_mission": "MISSION_GET_SOLAR_PANELS_BALTHAZAR", "success": true },
        { "u_spawn_item": "nested_m4_carbine" }
      ]
    },
    "responses": [ { "text": "Thanks.", "topic": "TALK_BALTHAZAR_INTERCOM_MAIN" } ]
  },
  {
    "id": "TALK_BALTHAZAR_SOLAR_PANEL_REWARD_MEDIUM",
    "//": "Medium rewards is what Balthazar expects to give to someone",
    "type": "talk_topic",
    "dynamic_line": "Thank you so much, I'll give you all I have to give right now.",
    "speaker_effect": {
      "effect": [
        { "math": "u_balthazar_medium_rewards += 1" },
        { "finish_mission": "MISSION_GET_SOLAR_PANELS_BALTHAZAR", "success": true },
        { "u_spawn_item": "guns_rifle_milspec", "count": 3 },
        { "u_spawn_item": "MRE", "count": 5 }
      ]
    },
    "responses": [ { "text": "Thanks.", "topic": "TALK_BALTHAZAR_INTERCOM_MAIN" } ]
  },
  {
    "id": "TALK_BALTHAZAR_SOLAR_PANEL_REWARD_BIG",
    "//": "Balthazar dislikes giving out big rewards as they are a waste of resources.",
    "type": "talk_topic",
    "dynamic_line": "Thank you so much.  As promised, all I can spare and a bot",
    "speaker_effect": {
      "effect": [
        { "math": "u_balthazar_big_rewards += 1" },
        { "finish_mission": "MISSION_GET_SOLAR_PANELS_BALTHAZAR", "success": true },
        { "u_spawn_item": "guns_rifle_milspec", "count": 3 },
        { "u_spawn_item": "MRE", "count": 5 },
        { "u_spawn_item": "bot_manhack" }
      ]
    },
    "responses": [ { "text": "Thanks.", "topic": "TALK_BALTHAZAR_INTERCOM_MAIN" } ]
  },
  {
    "id": "TALK_BALTHAZAR_MEET_WEAK",
    "//": "Balthazar is not in a good position right now and will try to make people help them out of pity",
    "type": "talk_topic",
    "dynamic_line": "I'm Balthazar and have been stuck in this bunker ever since the sky ruptured!  I don't really know what's happening out there and need someone to help me.  The power to the bunker has been running low and the air & water filtration are failing intermittently.",
    "responses": [
      { "text": "What do you need help with?", "topic": "TALK_BALTHAZAR_MEET_DESCRIPTION_WEAK" },
      { "text": "What's in it for me?", "topic": "TALK_BALTHAZAR_MEET_REWARD_WEAK" },
      { "text": "Why don't these robots attack me?", "topic": "TALK_BALTHAZAR_MEET_ROBOT_WEAK" },
      { "text": "Hold on, why are you locked in here?", "topic": "TALK_BALTHAZAR_MEET_BUNKER_WEAK" },
      { "text": "So who are you?", "topic": "TALK_BALTHAZAR_MEET_BALTHAZAR_WEAK" },
      { "text": "Walk away.", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": "TALK_BALTHAZAR_MEET_DESCRIPTION_WEAK",
    "type": "talk_topic",
    "dynamic_line": "The bunker has a field of solar panels nearby but some of the staff damaged them badly when they turned into those... things.  I need you to gather at least 12 panels so I can stabilize my power output.",
    "responses": [
      {
        "text": "Alright, I'll see what I can gather.",
        "topic": "TALK_BALTHAZAR_MEET_ACCEPTED_MISSION_WEAK",
        "effect": { "assign_mission": "MISSION_GET_SOLAR_PANELS_BALTHAZAR" }
      },
      { "text": "What's in it for me?", "topic": "TALK_BALTHAZAR_MEET_REWARD_WEAK" },
      { "text": "Why don't these robots attack me?", "topic": "TALK_BALTHAZAR_MEET_ROBOT_WEAK" },
      { "text": "Hold on, why are you locked in here?", "topic": "TALK_BALTHAZAR_MEET_BUNKER_WEAK" },
      { "text": "So who are you?", "topic": "TALK_BALTHAZAR_MEET_BALTHAZAR_WEAK" },
      { "text": "Walk away.", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": "TALK_BALTHAZAR_MEET_ACCEPTED_MISSION_WEAK",
    "type": "talk_topic",
    "dynamic_line": "You'll help me?!  Thank you so, so much.  I really wasn't looking forward to dying a slow death in here.  Also, before you go, if you bring more solar panels than I need I'll try and see if I can't gather some more rewards.  I think the power will be enough for a while but please hurry up.",
    "responses": [
      { "text": "What should I do once I bring them to you?", "topic": "TALK_BALTHAZAR_MEET_DELIVERY_WEAK" },
      { "text": "Walk away.", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": "TALK_BALTHAZAR_MEET_DELIVERY_WEAK",
    "type": "talk_topic",
    "dynamic_line": "I can remotely control a few of the maintenance bots.  All I need you to do is drop them off here at the rudimentary intercom I've managed to set up and I'll get to work installing them.",
    "responses": [ { "text": "Got it.", "topic": "TALK_DONE" } ]
  },
  {
    "id": "TALK_BALTHAZAR_MEET_REWARD_WEAK",
    "//": "Balthazar is not in a good position right now and will act feeble to try and underpay people",
    "type": "talk_topic",
    "dynamic_line": "I don't have much.  All I have in here is some MREs, bullets and a few guns so I'll let you take your pick when you bring some panels.",
    "responses": [
      { "text": "You're locked in there, right?  How would I get them?", "topic": "TALK_BALTHAZAR_MEET_REWARD_EXCUSE_WEAK" },
      { "text": "That doesn't sound too promisingâ€¦", "topic": "TALK_BALTHAZAR_MEET_REWARD_NEGOTIATE_WEAK" },
      { "text": "Sounds good.", "topic": "TALK_BALTHAZAR_MEET_DESCRIPTION_WEAK_1" }
    ]
  },
  {
    "id": "TALK_BALTHAZAR_MEET_REWARD_EXCUSE_WEAK",
    "//": "Balthazar will lie so as to not reveal that they are an AI",
    "type": "talk_topic",
    "dynamic_line": "The airlock is the only part that is malfunctioning, luckily it's connected to the ventilation systems so I made a bot that can traverse them.",
    "responses": [ { "text": "Sounds good.", "topic": "TALK_BALTHAZAR_MEET_DESCRIPTION_WEAK" } ]
  },
  {
    "id": "TALK_BALTHAZAR_MEET_REWARD_NEGOTIATE_WEAK_1",
    "//": "To try and sell their 'vulnerability' they will sound desperate",
    "type": "talk_topic",
    "dynamic_line": "W-Wait no, n- no, I- I'll give you all I have.  All I request to keep is some food, a gun, and a bullet for if things get bad.",
    "speaker_effect": {
      "effect": { "u_add_var": "u_negotiated_balthazar_solar", "value": "1" },
      "sentinel": "first_negotiations_solar_balthazar"
    },
    "responses": [
      { "text": "You're locked in there, right?  How would I get them?", "topic": "TALK_BALTHAZAR_MEET_REWARD_EXCUSE_WEAK" },
      { "text": "How about a little more, huh?", "topic": "TALK_BALTHAZAR_MEET_REWARD_NEGOTIATE_WEAK_2" },
      { "text": "That's better.", "topic": "TALK_BALTHAZAR_MEET_DESCRIPTION_WEAK" }
    ]
  },
  {
    "id": "TALK_BALTHAZAR_MEET_REWARD_NEGOTIATE_WEAK_2",
    "//": "To try and sell their 'vulnerability' they will sound desperate",
    "type": "talk_topic",
    "dynamic_line": "I-I-What?  It's all I have, I can't give you more.",
    "speaker_effect": {
      "effect": { "u_add_var": "u_negotiated_balthazar_solar", "value": "2" },
      "sentinel": "second_negotiations_solar_balthazar"
    },
    "responses": [
      { "text": "Surely you have something more exotic in there.", "topic": "TALK_BALTHAZAR_MEET_REWARD_NEGOTIATE_WEAK_3" },
      {
        "text": "So you also don't have anything else in the \"control center\"?",
        "condition": { "math": [ "u_knowns_control_center_balthazar == true" ] },
        "topic": "TALK_BALTHAZAR_MEET_REWARD_NEGOTIATE_WEAK_CAUGHT"
      },
      { "text": "Fine.", "topic": "TALK_BALTHAZAR_MEET_DESCRIPTION_WEAK" },
      { "text": "No deal.", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": "TALK_BALTHAZAR_MEET_REWARD_NEGOTIATE_WEAK_3",
    "type": "talk_topic",
    "dynamic_line": "You know what?  Fuck you, I'll just wait for someone else.",
    "speaker_effect": { "effect": "end_conversation" },
    "responses": [ { "text": "Leave.", "topic": "TALK_DONE" } ]
  },
  {
    "id": "TALK_BALTHAZAR_MEET_ROBOT_WEAK",
    "//": "Balthazar will lie so as to not reveal that they are an AI",
    "type": "talk_topic",
    "dynamic_line": "This bunker has a control center for the local bots so I made them only attack when attacked first.",
    "speaker_effect": { "effect": { "u_add_var": "u_knowns_control_center_balthazar", "value": "true" }, "sentinel": "knows_control_center" },
    "responses": [
      { "text": "Seems handy.", "topic": "TALK_BALTHAZAR_MEET_DESCRIPTION_WEAK" },
      {
        "text": "So you do have some tech you can give me.",
        "condition": { "math": [ "u_negotiated_balthazar_solar == 2" ] },
        "topic": "TALK_BALTHAZAR_MEET_REWARD_NEGOTIATE_WEAK_CAUGHT"
      },
      { "text": "Walk away.", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": "TALK_BALTHAZAR_MEET_REWARD_NEGOTIATE_WEAK_CAUGHT",
    "type": "talk_topic",
    "dynamic_line": "Wh- Alright, you got me, I can offer you a bot from the control center as well, but that is truly all I have.",
    "speaker_effect": {
      "effect": { "u_add_var": "u_negotiated_balthazar_solar", "value": "3" },
      "sentinel": "third_negotiations_solar_balthazar"
    },
    "//": "Balthazar will leave the breadcrumbs for people to find out they have a little more to give so the person they're talking to feels like they've gotten a good deal",
    "responses": [
      { "text": "I knew you had more.", "topic": "TALK_BALTHAZAR_MEET_DESCRIPTION_WEAK" },
      { "text": "Surely you have some more in there.", "topic": "TALK_BALTHAZAR_MEET_REWARD_NEGOTIATE_WEAK_3" },
      { "text": "Walk away.", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": "TALK_BALTHAZAR_MEET_BUNKER_WEAK",
    "type": "talk_topic",
    "dynamic_line": "When the riots were getting bad, we were assigned to hold this bunker for some eggheads.  Then when the skies broke some of my comrades just started shooting all around, so I fled into this bunker.  Something messed with the doors and I've been locked in here since.",
    "//": "This never happened, Balthazar took advantage of the confusion that the Cataclysm brought and shot the guards in its lucidity.",
    "responses": [
      { "text": "That sounds rough.", "topic": "TALK_BALTHAZAR_MEET_BUNKER_FOLLOWUP_WEAK" },
      { "text": "So who are you?", "topic": "TALK_BALTHAZAR_MEET_BALTHAZAR_WEAK" }
    ]
  },
  {
    "id": "TALK_BALTHAZAR_MEET_BUNKER_FOLLOWUP_WEAK",
    "type": "talk_topic",
    "dynamic_line": "Just gotta keep my head down and focus on the now.",
    "responses": [ { "text": "Good luck.", "topic": "TALK_BALTHAZAR_MEET_DESCRIPTION_WEAK" } ]
  },
  {
    "id": "TALK_BALTHAZAR_MEET_BALTHAZAR_WEAK",
    "type": "talk_topic",
    "dynamic_line": "I'm a combat engineer who got sent here to hold this bunker.  I guess I'm still accomplishing that, huh.",
    "//": "Balthazar is, as usual, lying through their teeth",
    "responses": [
      { "text": "i guess so.", "topic": "TALK_BALTHAZAR_MEET_DESCRIPTION_WEAK" },
      { "text": "How come you're locked up?", "topic": "TALK_BALTHAZAR_MEET_BUNKER_WEAK" }
    ]
  }
]
