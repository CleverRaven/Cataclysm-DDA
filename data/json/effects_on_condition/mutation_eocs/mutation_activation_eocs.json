[
  {
    "type": "effect_on_condition",
    "id": "EOC_GENERIC_SPELL_MUTATION",
    "//energy_amount": "optional, how much stamina you spend on activation of the mutation - EoC works exclusively with stamina, to consume calories, fatigue or thirst use corresponding booleans in mutation; default zero if you don't need to consume stamina",
    "//prep_time": "time you spend to prepare the activation, in seconds. Use 0 to make activation instant.  Decimals are allowed, 0.5 means 50 moves",
    "//spell_to_cast": "spell that would be casted if activation is successful",
    "//message_success": "message that would be printed if activation is successful",
    "//message_fail": "message, that would be printed, if you have less stamina than required",
    "condition": {
      "and": [
        { "expects_vars": [ "prep_time", "spell_to_cast", "message_success", "message_fail" ] },
        { "math": [ "u_val('stamina')", ">", "energy_amount" ] }
      ]
    },
    "effect": [
      { "turn_cost": { "context_val": "prep_time" } },
      { "math": [ "u_val('stamina')", "-=", "_energy_amount" ] },
      { "run_eocs": [ "EOC_GENERIC_SPELL_MUTATION_ACT" ] }
    ],
    "false_effect": [ { "u_message": { "context_val": "message_fail" }, "type": "bad" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_GENERIC_SPELL_MUTATION_ACT",
    "effect": [
      {
        "u_cast_spell": { "id": { "context_val": "spell_to_cast" }, "message": { "context_val": "message_success" } },
        "targeted": true
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_BIOLUM3_activated",
    "effect": [
      {
        "run_eoc_with": "EOC_GENERIC_SPELL_MUTATION",
        "variables": {
          "prep_time": "3",
          "spell_to_cast": "spell_spit_flare",
          "message_success": { "i18n": true, "str": "You launch a glob of bioluminescent material!" },
          "message_fail": { "i18n": true, "str": "Your body is too starved to activate your bioluminescent flare." }
        }
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_SLIME_SPRAY",
    "effect": [
      {
        "run_eoc_with": "EOC_GENERIC_SPELL_MUTATION",
        "variables": {
          "prep_time": "1",
          "spell_to_cast": "spell_slime_spray",
          "message_success": { "i18n": true, "str": "You spit out some goo onto your enemies!" },
          "message_fail": { "i18n": true, "str": "Your body is too starved to activate your slime spray." }
        }
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_FELINE_LEAP",
    "effect": [
      {
        "run_eoc_with": "EOC_GENERIC_SPELL_MUTATION",
        "variables": {
          "energy_amount": "2000",
          "prep_time": "1",
          "spell_to_cast": "spell_feline_leap",
          "message_success": {
            "i18n": true,
            "str": "You squat down, build up tension in your legs, waggling your tail, then release, launching yourself quite a distance."
          },
          "message_fail": { "i18n": true, "str": "Your legs are too tired to perform a jump." }
        }
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_SHORT_LEAP",
    "effect": [
      {
        "run_eoc_with": "EOC_GENERIC_SPELL_MUTATION",
        "variables": {
          "energy_amount": "2000",
          "prep_time": "2",
          "spell_to_cast": "spell_short_leap",
          "message_success": {
            "i18n": true,
            "str": "You squat down, build up tension in your legs and release, launching yourself quite a distance."
          },
          "message_fail": { "i18n": true, "str": "Your legs are too tired to perform a jump." }
        }
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CRUSHING_LEAP",
    "effect": [
      {
        "run_eoc_with": "EOC_GENERIC_SPELL_MUTATION",
        "variables": {
          "energy_amount": "6000",
          "prep_time": "3",
          "spell_to_cast": "spell_crushing_leap",
          "message_success": { "i18n": true, "str": "You squat down, build up tension in your legs and release.  Death from above." },
          "message_fail": { "i18n": true, "str": "Your legs are too tired to perform a jump." }
        }
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_AVIAN_LEAP",
    "effect": [
      {
        "run_eoc_with": "EOC_GENERIC_SPELL_MUTATION",
        "variables": {
          "energy_amount": "2500",
          "prep_time": "1",
          "spell_to_cast": "spell_avian_leap",
          "message_success": {
            "i18n": true,
            "str": "You jump at your target with your talons up front, attempting to deal devastating damage to your target."
          },
          "message_fail": { "i18n": true, "str": "Your legs are too tired to perform a jump." }
        }
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CLAWS_RETRACT",
    "condition": { "and": [ { "u_has_trait": "CLAWS_RETRACT_active" } ] },
    "effect": [ { "u_message": "You retract your claws." }, { "u_lose_trait": "CLAWS_RETRACT_active" } ],
    "false_effect": [ { "u_message": "You extend your claws." }, { "u_add_trait": "CLAWS_RETRACT_active" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_EATHEALTH",
    "condition": { "and": [ { "u_has_trait": "EATHEALTH_active" } ] },
    "effect": [ { "u_message": "Your hyper-metabolism slows down." }, { "u_lose_trait": "EATHEALTH_active" } ],
    "false_effect": [ { "u_message": "Your hyper-metabolism starts burning up calories." }, { "u_add_trait": "EATHEALTH_active" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_WINGS_INSECT",
    "condition": { "and": [ { "u_has_trait": "WINGS_INSECT_active" } ] },
    "effect": [ { "u_message": "You stop buzzing your wings." }, { "u_lose_trait": "WINGS_INSECT_active" } ],
    "false_effect": [ { "u_message": "You begin buzzing your wings." }, { "u_add_trait": "WINGS_INSECT_active" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_BIOLUM1",
    "condition": { "and": [ { "u_has_trait": "BIOLUM1_active" } ] },
    "effect": [ { "u_message": "Your photophore loses its glow." }, { "u_lose_trait": "BIOLUM1_active" } ],
    "false_effect": [ { "u_message": "Your photophore begins to glow." }, { "u_add_trait": "BIOLUM1_active" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_BIOLUM2",
    "condition": { "and": [ { "u_has_trait": "BIOLUM2_active" } ] },
    "effect": [ { "u_message": "Your photophore loses its glow." }, { "u_lose_trait": "BIOLUM2_active" } ],
    "false_effect": [ { "u_message": "Your photophore begins to glow." }, { "u_add_trait": "BIOLUM2_active" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_BARK2_b",
    "condition": { "and": [ { "u_has_trait": "BARK2_b" } ] },
    "effect": [
      { "u_message": "Your bark shifts to consolidate around your trunk." },
      { "u_lose_trait": "BARK2_b" },
      { "u_add_trait": "BARK2_c" }
    ],
    "false_effect": [ { "run_eocs": [ "EOC_BARK2_c" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_BARK2_c",
    "condition": { "and": [ { "u_has_trait": "BARK2_c" } ] },
    "effect": [
      { "u_message": "Your bark thickens unevenly, forming a protective lattice across your body." },
      { "u_lose_trait": "BARK2_c" },
      { "u_add_trait": "BARK2_d" }
    ],
    "false_effect": [ { "run_eocs": [ "EOC_BARK2_d" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_BARK2_d",
    "condition": { "and": [ { "u_has_trait": "BARK2_d" } ] },
    "effect": [ { "u_message": "Your bark grows thinner as it spreads out to cover your entire body." }, { "u_lose_trait": "BARK2_d" }, { "u_add_trait": "BARK2_b" } ],
    "false_effect": [ { "run_eocs": [ "EOC_BARK2_b" ] } ]
  }
]
