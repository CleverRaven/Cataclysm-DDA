[
  {
    "type": "effect_on_condition",
    "id": "mut_eyestalk",
    "recurrence": [ "2 hours 15 minutes", "10 hours 15 minutes" ],
    "condition": {
      "and": [
        { "u_has_trait": "EYESTALKS1" },
        { "not": { "or": [ { "u_has_effect": "visuals" }, { "u_has_effect": "narcosis" } ] } }
      ]
    },
    "deactivate_condition": { "not": { "u_has_trait": "EYESTALKS1" } },
    "effect": [
      { "u_message": "Your vision inverts!", "type": "bad" },
      { "sound_effect": "pixelated", "id": "bionics", "volume": 50 },
      { "u_add_effect": "visuals", "duration": "10 minutes" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "chitin2_molt_timer1",
    "recurrence": [ "24 days", "42 days" ],
    "condition": {
      "and": [
        { "u_has_trait": "CHITIN2" },
        { "not": { "u_has_effect": "molting" } },
        { "not": { "u_has_effect": "molting_imminent" } },
        { "not": { "u_has_trait": "CHITIN3" } },
        { "not": { "u_has_trait": "CRUSTACEAN_CARAPACE" } }
      ]
    },
    "effect": [ { "u_add_effect": "molting", "intensity": 1, "duration": "PERMANENT" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "chitin2_molt_timer2",
    "recurrence": [ "1 days", "2 days" ],
    "condition": {
      "and": [
        { "u_has_effect": "molting" },
        { "not": { "u_has_effect": "molting_imminent" } },
        { "not": { "u_has_trait": "CHITIN3" } },
        { "not": { "u_has_trait": "CRUSTACEAN_CARAPACE" } }
      ]
    },
    "effect": [ { "u_add_effect": "molting_imminent", "intensity": 1, "duration": "PERMANENT" }, { "u_lose_effect": "molting" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "chitin2_molt_timer_3",
    "recurrence": [ "1 hours", "3 hours" ],
    "condition": {
      "and": [
        { "u_has_effect": "molting_imminent" },
        { "not": { "u_has_effect": "molting" } },
        { "not": { "u_has_trait": "CHITIN3" } },
        { "not": { "u_has_trait": "CRUSTACEAN_CARAPACE" } }
      ]
    },
    "effect": [
      { "u_add_effect": "narcosis", "duration": "5 minutes" },
      { "u_add_effect": "sleep", "duration": "5 minutes" },
      {
        "u_message": "Your exoskeleton grows steadily more rigid until you can no longer move. You strain against it for a few minutes, and it peels and cracks away in chunks like a plaster mold, revealing a soft and tender new layer beneath.",
        "type": "bad"
      },
      { "u_lose_trait": "CHITIN2" },
      { "u_lose_trait": "CHITIN" },
      { "u_lose_effect": "molting_imminent" },
      { "u_spawn_item": "chitin_piece", "count": 3 },
      { "u_add_trait": "CHITIN_MOLTED" },
      { "u_add_trait": "CHITIN2_MOLTED" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "chitin2_molt_timer4",
    "recurrence": [ "8 hours", "12 hours" ],
    "condition": {
      "and": [
        { "u_has_trait": "CHITIN2_MOLTED" },
        { "not": { "u_has_effect": "molting" } },
        { "not": { "u_has_effect": "molting_imminent" } },
        { "not": { "u_has_trait": "CHITIN3_MOLTED" } },
        { "not": { "u_has_trait": "CRUSTACEAN_CARAPACE_MOLTED" } }
      ]
    },
    "effect": [
      { "u_message": "Your exoskeleton has finished hardening.", "type": "good" },
      { "u_lose_trait": "CHITIN_MOLTED" },
      { "u_lose_trait": "CHITIN2_MOLTED" },
      { "u_add_trait": "CHITIN" },
      { "u_add_trait": "CHITIN2" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "chitin3_molt_timer1",
    "recurrence": [ "24 days", "42 days" ],
    "condition": {
      "and": [
        { "u_has_trait": "CHITIN2" },
        { "or": [ { "u_has_trait": "CHITIN3" }, { "u_has_trait": "CRUSTACEAN_CARAPACE" } ] },
        { "not": { "u_has_effect": "molting" } },
        { "not": { "u_has_effect": "molting_imminent" } }
      ]
    },
    "effect": [ { "u_add_effect": "molting", "intensity": 1, "duration": "PERMANENT" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "chitin3_molt_timer2",
    "recurrence": [ "1 days", "2 days" ],
    "condition": {
      "and": [
        { "u_has_effect": "molting" },
        { "u_has_trait": "CHITIN2" },
        { "or": [ { "u_has_trait": "CHITIN3" }, { "u_has_trait": "CRUSTACEAN_CARAPACE" } ] },
        { "not": { "u_has_effect": "molting_imminent" } }
      ]
    },
    "effect": [ { "u_add_effect": "molting_imminent", "intensity": 1, "duration": "PERMANENT" }, { "u_lose_effect": "molting" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "chitin3_molt_timer3",
    "recurrence": [ "1 hours", "3 hours" ],
    "condition": {
      "and": [
        { "u_has_trait": "CHITIN2" },
        { "u_has_trait": "CHITIN3" },
        { "u_has_effect": "molting_imminent" },
        { "not": { "u_has_effect": "molting" } }
      ]
    },
    "effect": [
      { "u_add_effect": "narcosis", "duration": "15 minutes" },
      { "u_add_effect": "sleep", "duration": "15 minutes" },
      {
        "u_message": "Your exoskeleton locks up around you like a straitjacket, completely immobilizing you.  As you try to move, you begin to feel it painlessly rip, opening a hole through which you can slowly emerge, raw, soft, and vulnerable.",
        "type": "bad"
      },
      { "u_lose_trait": "CHITIN3" },
      { "u_lose_trait": "CHITIN2" },
      { "u_lose_trait": "CHITIN" },
      { "u_lose_effect": "molting_imminent" },
      { "u_spawn_item": "chitin_piece", "count": 4 },
      { "u_add_trait": "CHITIN_MOLTED" },
      { "u_add_trait": "CHITIN2_MOLTED" },
      { "u_add_trait": "CHITIN3_MOLTED" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "chitin3_molt_timer4",
    "recurrence": [ "8 hours", "12 hours" ],
    "condition": {
      "and": [
        { "u_has_trait": "CHITIN2_MOLTED" },
        { "u_has_trait": "CHITIN3_MOLTED" },
        { "not": { "u_has_effect": "molting" } },
        { "not": { "u_has_effect": "molting_imminent" } }
      ]
    },
    "effect": [
      { "u_message": "Your exoskeleton has finished hardening.", "type": "good" },
      { "u_lose_trait": "CHITIN3_MOLTED" },
      { "u_lose_trait": "CHITIN2_MOLTED" },
      { "u_lose_trait": "CHITIN_MOLTED" },
      { "u_add_trait": "CHITIN" },
      { "u_add_trait": "CHITIN2" },
      { "u_add_trait": "CHITIN3" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "chitin_carapace_molt_timer3",
    "recurrence": [ "1 hours", "3 hours" ],
    "condition": {
      "and": [
        { "u_has_trait": "CHITIN2" },
        { "u_has_trait": "CRUSTACEAN_CARAPACE" },
        { "u_has_effect": "molting_imminent" },
        { "not": { "u_has_effect": "molting" } }
      ]
    },
    "effect": [
      { "u_add_effect": "narcosis", "duration": "15 minutes" },
      { "u_add_effect": "sleep", "duration": "15 minutes" },
      {
        "u_message": "Your exoskeleton locks up around you like a straitjacket, completely immobilizing you.  As you try to move, you begin to feel it painlessly rip, opening a hole through which you can slowly emerge, raw, soft, and vulnerable.",
        "type": "bad"
      },
      { "u_lose_trait": "CRUSTACEAN_CARAPACE" },
      { "u_lose_trait": "CHITIN2" },
      { "u_lose_trait": "CHITIN" },
      { "u_lose_effect": "molting_imminent" },
      { "u_spawn_item": "chitin_piece", "count": 5 },
      { "u_add_trait": "CHITIN_MOLTED" },
      { "u_add_trait": "CHITIN2_MOLTED" },
      { "u_add_trait": "CRUSTACEAN_CARAPACE_MOLTED" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "chitin_carapace_molt_timer4",
    "recurrence": [ "8 hours", "12 hours" ],
    "condition": {
      "and": [
        { "u_has_trait": "CHITIN2_MOLTED" },
        { "u_has_trait": "CRUSTACEAN_CARAPACE_MOLTED" },
        { "not": { "u_has_effect": "molting" } },
        { "not": { "u_has_effect": "molting_imminent" } }
      ]
    },
    "effect": [
      { "u_message": "Your exoskeleton has finished hardening.", "type": "good" },
      { "u_lose_trait": "CRUSTACEAN_CARAPACE_MOLTED" },
      { "u_lose_trait": "CHITIN2_MOLTED" },
      { "u_lose_trait": "CHITIN_MOLTED" },
      { "u_add_trait": "CHITIN" },
      { "u_add_trait": "CHITIN2" },
      { "u_add_trait": "CRUSTACEAN_CARAPACE" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "rashy_skin",
    "recurrence": [ "2 hours", "24 hours" ],
    "condition": { "and": [ { "u_has_trait": "SKIN_RASHY" }, { "not": { "u_has_effect": "formication" } } ] },
    "effect": [ { "u_add_effect": "formication", "duration": "10 minutes", "target_part": "random" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "hay_fever_spring_fall",
    "recurrence": [ "4 hours", "3 days" ],
    "condition": {
      "and": [
        { "u_has_trait": "SEASONAL_ALLERGIES" },
        { "or": [ { "is_season": "spring" }, { "is_season": "fall" } ] },
        { "not": { "u_has_effect": "took_flumed" } },
        { "not": { "u_has_effect": "hay_fever" } }
      ]
    },
    "effect": [
      { "u_message": "Your eyes water and your nose itches.", "type": "bad" },
      { "u_add_effect": "hay_fever", "duration": { "math": [ "rand(28800) + 600" ] } }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "hay_fever_summer",
    "recurrence": [ "2 hours", "36 hours" ],
    "condition": {
      "and": [
        { "u_has_trait": "SEASONAL_ALLERGIES" },
        { "is_season": "SUMMER" },
        { "not": { "u_has_effect": "took_flumed" } },
        { "not": { "u_has_effect": "hay_fever" } }
      ]
    },
    "effect": [
      { "u_message": "Your eyes water and your nose itches.", "type": "bad" },
      {
        "u_add_effect": "hay_fever",
        "duration": { "math": [ "rand(28800) + 600" ] }
      } ]
  },
  {
    "type": "effect_on_condition",
    "id": "sneeze",
    "recurrence": [ "45 seconds", "30 minutes" ],
    "condition": {
      "and": [
        { "u_has_effect": "hay_fever" },
        { "not": { "u_has_effect": "took_flumed" } },
        { "not": { "u_has_effect": "narcosis" } }
      ]
    },
    "effect": [
      { "u_message": "You sneeze!", "type": "bad" },
      { "u_add_effect": "sneezing", "duration": "1 second" },
      { "u_make_sound": "a sneeze!", "volume": 10, "type": "speech" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "flowers_winter_timer",
    "recurrence": [ "15 hours", "60 hours" ],
    "condition": {
      "and": [
        { "is_season": "winter" },
        { "u_has_trait": "FLOWERS" } 
      ]
    },
    "effect": [
      {
        "u_message": "A somber feeling comes over you as the last petals of your wilting flowers fall from your head.",
        "type": "bad"
      },
      { "u_lose_trait": "FLOWERS" },
      { "u_add_trait": "FLOWERS_WINTER" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "flowers_spring_summer_fall_timer",
    "recurrence": [ "15 hours", "60 hours" ],
    "condition": {
      "and": [
        { "or": [ { "is_season": "spring" }, { "is_season": "summer" }, { "is_season": "fall" } ] },
        { "u_has_trait": "FLOWERS_WINTER" } 
      ]
    },
    "effect": [
      { "u_message": "You feel a giddy thrill as new flowers bloom from your scalp.", "type": "good" },
      { "u_lose_trait": "FLOWERS_WINTER" },
      { "u_add_trait": "FLOWERS" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "rosebuds_spring_timer",
    "recurrence": [ "15 hours", "60 hours" ],
    "condition": {
      "and": [
        {
          "or": [ { "u_has_trait": "ROSEBUDS_SUMMER" }, { "u_has_trait": "ROSEBUDS_FALL" }, { "u_has_trait": "ROSEBUDS_WINTER" } ]
        },
        { "is_season": "spring" }
      ]
    },
    "effect": [
      {
        "u_message": "Spring must be here, the new buds growing from your scalp are giving off a lovely scent.",
        "type": "good"
      },
      { "u_lose_trait": "ROSEBUDS_WINTER" },
      { "u_lose_trait": "ROSEBUDS_SUMMER" },
      { "u_lose_trait": "ROSEBUDS_FALL" },
      { "u_add_trait": "ROSEBUDS" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "rosebuds_summer_timer",
    "recurrence": [ "15 hours", "60 hours" ],
    "condition": {
      "and": [
        { "or": [ { "u_has_trait": "ROSEBUDS" }, { "u_has_trait": "ROSEBUDS_FALL" }, { "u_has_trait": "ROSEBUDS_WINTER" } ] },
        { "is_season": "summer" } 
      ]
    },
    "effect": [
      { "u_message": "Your blossoms come into full bloom, sending a brief flush of warmth through your body.", "type": "good" },
      { "u_lose_trait": "ROSEBUDS_WINTER" },
      { "u_lose_trait": "ROSEBUDS" },
      { "u_lose_trait": "ROSEBUDS_FALL" },
      { "u_add_trait": "ROSEBUDS_SUMMER" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "rosebuds_fall_timer_plant",
    "recurrence": [ "15 hours", "60 hours" ],
    "condition": {
      "and": [
        { "or": [ { "u_has_trait": "ROSEBUDS" }, { "u_has_trait": "ROSEBUDS_SUMMER" }, { "u_has_trait": "ROSEBUDS_WINTER" } ] },
        { "u_has_trait": "THRESH_PLANT" },
        { "is_season": "fall" } 
      ]
    },
    "effect": [
      {
        "u_message": "Your flowers have withered away and died.  In their place, a few small fruits hang from your head.",
        "type": "good"
      },
      { "u_lose_trait": "ROSEBUDS_WINTER" },
      { "u_lose_trait": "ROSEBUDS" },
      { "u_lose_trait": "ROSEBUDS_SUMMER" },
      { "u_add_trait": "ROSEBUDS_FALL" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "rosebuds_fall_timer_elfa",
    "//": "Only true plants bear fruit. Elves just look pretty for longer.",
    "recurrence": [ "15 hours", "60 hours" ],
    "condition": {
      "and": [
        { "or": [ { "u_has_trait": "ROSEBUDS" }, { "u_has_trait": "ROSEBUDS" }, { "u_has_trait": "ROSEBUDS_WINTER" } ] },
        { "not": { "u_has_trait": "THRESH_PLANT" } },
        { "is_season": "fall" }
      ]
    },
    "effect": [
      {
        "u_message": "Your blossoms come into full bloom, sending a brief flush of warmth through your body.",
        "type": "good"
      },
      { "u_lose_trait": "ROSEBUDS_WINTER" },
      { "u_lose_trait": "ROSEBUDS" },
      { "u_lose_trait": "ROSEBUDS_FALL" },
      { "u_add_trait": "ROSEBUDS_SUMMER" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "rosebuds_winter_timer",
    "recurrence": [ "15 hours", "60 hours" ],
    "condition": {
      "and": [
        { "or": [ { "u_has_trait": "ROSEBUDS" }, { "u_has_trait": "ROSEBUDS_FALL" }, { "u_has_trait": "ROSEBUDS_SUMMER" } ] },
        { "is_season": "winter" }
      ]
    },
    "effect": [
      {
        "u_message": "Winter claims the last few vestiges of your flowers, leaving your crown bare of adornment.",
        "type": "bad"
      },
      { "u_lose_trait": "ROSEBUDS_SUMMER" },
      { "u_lose_trait": "ROSEBUDS" },
      { "u_lose_trait": "ROSEBUDS_FALL" },
      { "u_add_trait": "ROSEBUDS_WINTER" }
    ]
  }
]
