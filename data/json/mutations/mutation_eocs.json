[
  {
    "type": "effect_on_condition",
    "id": "eoc_vision_glare",
    "condition": "u_can_see",
    "effect": [
      { "u_message": "The lights grow uncomfortably bright.", "type": "bad" },
      { "u_add_effect": "glare", "duration": "3 minutes" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "eoc_vision_blind",
    "condition": "u_can_see",
    "effect": [
      { "u_message": "Your eyes fail you, and everything turns dark.", "type": "bad" },
      { "u_add_effect": "blind", "duration": "3 s" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "eoc_vision_stun",
    "condition": "u_can_see",
    "effect": [
      { "u_message": "The world starts turning wildly, and you stumble.", "type": "bad" },
      { "u_add_effect": "stunned", "duration": "8 s" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "eoc_vision_down",
    "condition": "u_can_see",
    "effect": [
      { "u_message": "Your vision flickers, and you fall to the ground!", "type": "bad" },
      { "u_add_effect": "downed", "duration": "3 s" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "eoc_vision_hallu",
    "condition": "u_can_see",
    "effect": [
      { "u_message": "The world looks unreal for a moment.", "type": "bad" },
      { "u_add_effect": "hallu", "duration": "3 h" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "eoc_arm_pain",
    "effect": [ { "u_message": "<arm_pain>", "snippet": true }, { "arithmetic": [ { "u_val": "pain" }, "+=", { "const": 5 } ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "eoc_arm_drop",
    "condition": "u_has_weapon",
    "effect": [ { "u_message": "<arm_drop>", "snippet": true }, "player_weapon_drop" ]
  },
  {
    "type": "effect_on_condition",
    "id": "eoc_arm_itch",
    "effect": [
      { "u_message": "<arm_itch>", "snippet": true },
      { "u_add_effect": "formication", "duration": 3600, "target_part": "arm_l" },
      { "u_add_effect": "formication", "duration": 3600, "target_part": "arm_r" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "arms_pre_feather_check",
    "recurrence_min": "5 s",
    "recurrence_max": "10 s",
    "condition": { "u_has_trait": "ARM_PRE_FEATHERS" },
    "deactivate_condition": { "not": { "u_has_trait": "ARM_PRE_FEATHERS" } },
    "effect": [
      { "u_message": "POLLY WANTS SOME FEATHERS, BABY" },
      {
        "arithmetic": [ { "u_val": "var", "var_name": "arms_feather", "type": "progress", "context": "mutation" }, "+=", { "const": 1 } ]
      },
      { "arithmetic": [ { "u_val": "vitamin", "name": "mutagen_bird" }, "-=", { "const": 100 } ] },
      { "arithmetic": [ { "u_val": "vitamin", "name": "mutagen_raptor" }, "-=", { "const": 100 } ] },
      {
        "queue_eocs": [
          {
            "id": "arms_pre_feather_progress",
            "//": "Checks to progress towards feathered arms if you drank your birb mutagen like a good little chick",
            "condition": {
              "and": [
                { "u_has_trait": "ARM_PRE_FEATHERS" },
                { "or": [ { "u_has_trait": "FEATHERS" }, { "u_has_trait": "DOWN" } ] },
                {
                  "or": [
                    { "compare_int": [ { "u_val": "vitamin", "name": "mutagen_bird" }, ">=", { "const": 200 } ] },
                    { "compare_int": [ { "u_val": "vitamin", "name": "mutagen_raptor" }, ">=", { "const": 100 } ] }
                  ]
                },
                { "u_compare_var": "arms_feather", "type": "progress", "context": "mutation", "op": ">=", "value": 5 }
              ]
            },
            "false_effect": [
              { "u_message": "<mutagen_bird_raptor>", "snippet": true },
              { "weighted_list_eocs": [ [ "eoc_null", 1 ], [ "eoc_arm_pain", 2 ], [ "eoc_arm_itch", 5 ] ] }
            ],
            "effect": [
              {
                "u_message": "Your arms suddenly start itching, and you shake them vigorously.  To your painful surprise a new cover of longer, stronger feathers broke the surface, old skin and plumage falling on the ground.",
                "type": "bad"
              },
              { "u_message": "Your Changing Arms mutation turns into Feathered Arms!", "type": "mixed" },
              { "u_lose_var": "arms_feather", "type": "progress", "context": "mutation" },
              { "u_lose_trait": "ARM_PRE_FEATHERS" },
              { "u_add_trait": "ARM_FEATHERS" }
            ]
          }
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "arms_feather_check",
    "//": "Active if you have feathered arms, and either bird thresh or no threshold at all, increments time-based counter and checks the rest",
    "recurrence_min": "5 s",
    "recurrence_max": "10 s",
    "condition": {
      "and": [
        { "u_has_trait": "ARM_FEATHERS" },
        { "or": [ { "not": { "u_has_flag": "MUTATION_THRESHOLD" } }, { "u_has_trait": "THRESH_BIRD" } ] }
      ]
    },
    "deactivate_condition": { "not": { "u_has_trait": "ARM_FEATHERS" } },
    "effect": [
      {
        "arithmetic": [ { "u_val": "var", "var_name": "wings_bird", "type": "progress", "context": "mutation" }, "+=", { "const": 1 } ]
      },
      { "arithmetic": [ { "u_val": "vitamin", "name": "mutagen_bird" }, "-=", { "const": 1 } ] },
      {
        "queue_eocs": [
          {
            "id": "arms_feather_sleep",
            "//": "Checks if you're asleep (and the more dramatic changes can happen) or not (to trigger the adjustment EOCs)",
            "condition": { "u_has_effect": "sleep" },
            "false_effect": [
              {
                "queue_eocs": [
                  {
                    "id": "arms_feather_awake",
                    "//": "Prints a hint if you'd need more mutagen for the progression, reminds you to sleep well.",
                    "condition": { "compare_int": [ { "u_val": "vitamin", "name": "mutagen_bird" }, "<", { "const": 400 } ] },
                    "effect": [ { "u_message": "<mutagen_bird>", "snippet": true } ],
                    "false_effect": [ { "u_message": "You are so close to your first flight, but you need to gather your strength for it.  Rest." } ]
                  }
                ]
              },
              {
                "weighted_list_eocs": [ [ "eoc_null", 1 ], [ "eoc_arm_pain", 5 ], [ "eoc_arm_drop", 1 ], [ "eoc_arm_itch", 5 ] ]
              }
            ],
            "effect": [
              {
                "queue_eocs": [
                  {
                    "id": "arms_feather_progress",
                    "//": "Checks to progress towards proper wings if you drank your birb mutagen like a good little chick and had about a week to grow your feathers. Pretty dramatic change, so have it happen while asleep",
                    "condition": {
                      "and": [
                        { "u_has_trait": "ARM_FEATHERS" },
                        { "u_has_trait": "THRESH_BIRD" },
                        { "u_has_trait": "HOLLOW_BONES" },
                        { "compare_int": [ { "u_val": "vitamin", "name": "mutagen_bird" }, ">=", { "const": 400 } ] },
                        {
                          "u_compare_var": "wings_bird",
                          "type": "progress",
                          "context": "mutation",
                          "op": ">",
                          "value": 7
                        }
                      ]
                    },
                    "false_effect": [ { "u_message": "<arms_feather_dream>", "snippet": true, "popup": true } ],
                    "effect": [
                      { "u_message": "<wings_bird_success>", "snippet": true, "popup": true },
                      { "u_lose_effect": "sleep" },
                      { "u_lose_var": "wings_bird", "type": "progress", "context": "mutation" },
                      { "u_lose_trait": "ARM_FEATHERS" },
                      { "u_add_trait": "ARM_WINGS_BIRD" },
                      { "arithmetic": [ { "u_val": "vitamin", "name": "mutagen_bird" }, "-=", { "const": 500 } ] }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "arms_pre_bat_check",
    "recurrence_min": "5 s",
    "recurrence_max": "10 s",
    "condition": { "u_has_trait": "ARM_PRE_BAT" },
    "deactivate_condition": { "not": { "u_has_trait": "ARM_PRE_BAT" } },
    "effect": [
      { "u_message": "I AM THE NIGHT" },
      {
        "arithmetic": [ { "u_val": "var", "var_name": "arms_bat", "type": "progress", "context": "mutation" }, "+=", { "const": 1 } ]
      },
      { "arithmetic": [ { "u_val": "vitamin", "name": "mutagen" }, "-=", { "const": 100 } ] },
      {
        "queue_eocs": [
          {
            "id": "arms_pre_bat_progress",
            "//": "Checks to progress towards flappy arms if you drank your mutagen like a good little transhuman",
            "condition": {
              "and": [
                { "u_has_trait": "ARM_PRE_BAT" },
                { "compare_int": [ { "u_val": "vitamin", "name": "mutagen" }, ">=", { "const": 200 } ] },
                { "u_compare_var": "arms_bat", "type": "progress", "context": "mutation", "op": ">", "value": 5 }
              ]
            },
            "false_effect": [ { "u_message": "<mutagen>", "snippet": true } ],
            "effect": [
              {
                "u_message": "The skin on your arms flakes off in long strips, revealing a large, pinkish membrane rolled up beneath.",
                "type": "mixed"
              },
              { "u_message": "Your Changing Arms mutation turns into Leathery Arms!", "type": "mixed" },
              { "u_lose_var": "arms_bat", "type": "progress", "context": "mutation" },
              { "u_lose_trait": "ARM_PRE_BAT" },
              { "u_add_trait": "ARM_BAT" }
            ]
          }
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "arms_bat_check",
    "recurrence_min": "5 s",
    "recurrence_max": "10 s",
    "condition": { "u_has_trait": "ARM_BAT" },
    "deactivate_condition": { "not": { "u_has_trait": "ARM_BAT" } },
    "effect": [
      { "u_message": "I AM THE NIIIIIGHT" },
      {
        "arithmetic": [ { "u_val": "var", "var_name": "wings_bat", "type": "progress", "context": "mutation" }, "+=", { "const": 1 } ]
      },
      { "arithmetic": [ { "u_val": "vitamin", "name": "mutagen" }, "-=", { "const": 100 } ] },
      {
        "queue_eocs": [
          {
            "id": "arms_bat_sleep",
            "//": "Checks if you're asleep (and the more dramatic changes can happen) or not (to trigger the adjustment EOCs)",
            "condition": { "u_has_effect": "sleep" },
            "false_effect": [
              {
                "queue_eocs": [
                  {
                    "id": "arms_bat_awake",
                    "//": "Prints a hint if you'd need more mutagen for the progression, reminds you to sleep well.",
                    "condition": { "compare_int": [ { "u_val": "vitamin", "name": "mutagen" }, "<", { "const": 400 } ] },
                    "effect": [ { "u_message": "<mutagen>", "snippet": true } ],
                    "false_effect": [ { "u_message": "You are so close to your first flight, but you need to gather your strength for it.  Rest." } ]
                  }
                ]
              },
              {
                "weighted_list_eocs": [ [ "eoc_null", 1 ], [ "eoc_arm_pain", 5 ], [ "eoc_arm_drop", 1 ], [ "eoc_arm_itch", 5 ] ]
              }
            ],
            "effect": [
              {
                "queue_eocs": [
                  {
                    "id": "arms_bat_progress",
                    "//": "Checks to progress towards proper wings if you drank your birb mutagen like a good little chick and had about a week to grow your feathers. Pretty dramatic change, so have it happen while asleep",
                    "condition": {
                      "and": [
                        { "u_has_trait": "ARM_BAT" },
                        { "compare_int": [ { "u_val": "vitamin", "name": "mutagen" }, ">=", { "const": 500 } ] },
                        {
                          "u_compare_var": "wings_bat",
                          "type": "progress",
                          "context": "mutation",
                          "op": ">",
                          "value": 5
                        }
                      ]
                    },
                    "false_effect": [ { "u_message": "<arms_bat_dream>", "snippet": true, "popup": true } ],
                    "effect": [
                      { "u_message": "<wings_bat_success>", "snippet": true, "popup": true },
                      { "u_lose_effect": "sleep" },
                      { "u_lose_var": "wings_bat", "type": "progress", "context": "mutation" },
                      { "u_lose_trait": "ARM_BAT" },
                      { "u_add_trait": "WINGS_BAT" },
                      { "arithmetic": [ { "u_val": "vitamin", "name": "mutagen" }, "-=", { "const": 500 } ] }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "arms_pre_spider_upper_check",
    "recurrence_min": "5 s",
    "recurrence_max": "10 s",
    "condition": { "u_has_trait": "ARM_PRE_SPIDER_UPPER" },
    "deactivate_condition": { "not": { "u_has_trait": "ARM_PRE_SPIDER_UPPER" } },
    "effect": [
      { "u_message": "Upper spider senses tingling!" },
      {
        "arithmetic": [ { "u_val": "var", "var_name": "arms_spider_upper", "type": "progress", "context": "mutation" }, "+=", { "const": 1 } ]
      },
      { "arithmetic": [ { "u_val": "vitamin", "name": "mutagen_spider" }, "-=", { "const": 100 } ] },
      {
        "queue_eocs": [
          {
            "id": "arms_pre_spider_upper_progress",
            "//": "Checks to progress towards flappy arms if you drank your mutagen like a good little transhuman",
            "condition": {
              "and": [
                { "u_has_trait": "ARM_PRE_BAT" },
                { "compare_int": [ { "u_val": "vitamin", "name": "mutagen_spider" }, ">=", { "const": 200 } ] },
                {
                  "u_compare_var": "arms_spider_upper",
                  "type": "progress",
                  "context": "mutation",
                  "op": ">",
                  "value": 5
                }
              ]
            },
            "false_effect": [ { "u_message": "<mutagen_spider>", "snippet": true } ],
            "effect": [
              {
                "u_message": "Something strains in your back, and a pair of spindly spider legs break forth with a loud snap!",
                "type": "mixed"
              },
              { "u_message": "Your Back Lumps mutation turns into Emerging Spider Limbs!", "type": "mixed" },
              { "u_lose_var": "arms_spider_upper", "type": "progress", "context": "mutation" },
              { "u_lose_trait": "ARM_PRE_SPIDER_UPPER" },
              { "u_add_trait": "ARM_SPIDER_UPPER" }
            ]
          }
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "arms_spider_upper_check",
    "recurrence_min": "5 s",
    "recurrence_max": "10 s",
    "condition": {
      "and": [
        { "u_has_trait": "ARM_SPIDER_UPPER" },
        { "or": [ { "not": { "u_has_flag": "MUTATION_THRESHOLD" } }, { "u_has_trait": "THRESH_SPIDER" } ] }
      ]
    },
    "deactivate_condition": { "not": { "u_has_trait": "ARM_SPIDER_UPPER" } },
    "effect": [
      { "u_message": "Upper spider senses tingling titillatingly" },
      {
        "arithmetic": [
          { "u_val": "var", "var_name": "arms_spider_upper_good", "type": "progress", "context": "mutation" },
          "+=",
          { "const": 1 }
        ]
      },
      { "arithmetic": [ { "u_val": "vitamin", "name": "mutagen_spider" }, "-=", { "const": 100 } ] },
      {
        "queue_eocs": [
          {
            "id": "arms_spider_upper_sleep",
            "//": "Checks if you're asleep (and the more dramatic changes can happen) or not (to trigger the adjustment EOCs)",
            "condition": { "u_has_effect": "sleep" },
            "false_effect": [
              {
                "queue_eocs": [
                  {
                    "id": "arms_spider_upper_awake",
                    "//": "Prints a hint if you'd need more mutagen for the progression, reminds you to sleep well.",
                    "condition": { "compare_int": [ { "u_val": "vitamin", "name": "mutagen_spider" }, "<", { "const": 400 } ] },
                    "effect": [ { "u_message": "<mutagen_spider>", "snippet": true } ],
                    "false_effect": [ { "u_message": "Spin a web and rest.  You need to gather your strength." } ]
                  }
                ]
              },
              { "weighted_list_eocs": [ [ "eoc_null", 1 ] ] }
            ],
            "effect": [
              {
                "queue_eocs": [
                  {
                    "id": "arms_spider_upper_progress",
                    "condition": {
                      "and": [
                        { "u_has_trait": "ARM_SPIDER_UPPER" },
                        { "u_has_trait": "THRESH_SPIDER" },
                        {
                          "compare_int": [ { "u_val": "vitamin", "name": "mutagen_spider" }, ">=", { "const": 500 } ]
                        },
                        {
                          "u_compare_var": "arms_spider_upper_good",
                          "type": "progress",
                          "context": "mutation",
                          "op": ">",
                          "value": 7
                        }
                      ]
                    },
                    "false_effect": [ { "u_message": "<arms_spider_dream>", "snippet": true, "popup": true } ],
                    "effect": [
                      { "u_message": "<arms_spider_upper_success>", "snippet": true, "popup": true },
                      { "u_lose_effect": "sleep" },
                      { "u_lose_var": "arms_spider_upper_good", "type": "progress", "context": "mutation" },
                      { "u_lose_trait": "ARM_SPIDER_UPPER" },
                      { "u_add_trait": "ARM_SPIDER_UPPER_GOOD" },
                      { "arithmetic": [ { "u_val": "vitamin", "name": "mutagen_spider" }, "-=", { "const": 500 } ] }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "arms_pre_spider_lower_check",
    "recurrence_min": "5 s",
    "recurrence_max": "10 s",
    "condition": { "u_has_trait": "ARM_PRE_SPIDER_LOWER" },
    "deactivate_condition": { "not": { "u_has_trait": "ARM_PRE_SPIDER_LOWER" } },
    "effect": [
      { "u_message": "Lower spider senses tingling!" },
      {
        "arithmetic": [ { "u_val": "var", "var_name": "arms_spider_lower", "type": "progress", "context": "mutation" }, "+=", { "const": 1 } ]
      },
      { "arithmetic": [ { "u_val": "vitamin", "name": "mutagen_spider" }, "-=", { "const": 100 } ] },
      {
        "queue_eocs": [
          {
            "id": "arms_pre_spider_lower_progress",
            "//": "Checks to progress towards flappy arms if you drank your mutagen like a good little transhuman",
            "condition": {
              "and": [
                { "u_has_trait": "ARM_PRE_BAT" },
                { "compare_int": [ { "u_val": "vitamin", "name": "mutagen_spider" }, ">=", { "const": 200 } ] },
                {
                  "u_compare_var": "arms_spider_lower",
                  "type": "progress",
                  "context": "mutation",
                  "op": ">",
                  "value": 5
                }
              ]
            },
            "false_effect": [ { "u_message": "<mutagen_spider>", "snippet": true } ],
            "effect": [
              {
                "u_message": "Something strains in your back, and a pair of spindly spider legs break forth with a loud snap!",
                "type": "mixed"
              },
              { "u_message": "Your Back Lumps mutation turns into Emerging Spider Limbs!", "type": "mixed" },
              { "u_lose_var": "arms_spider_lower", "type": "progress", "context": "mutation" },
              { "u_lose_trait": "ARM_PRE_SPIDER_LOWER" },
              { "u_add_trait": "ARM_SPIDER_LOWER" }
            ]
          }
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "arms_spider_lower_check",
    "recurrence_min": "5 s",
    "recurrence_max": "10 s",
    "condition": {
      "and": [
        { "u_has_trait": "ARM_SPIDER_LOWER" },
        { "or": [ { "not": { "u_has_flag": "MUTATION_THRESHOLD" } }, { "u_has_trait": "THRESH_SPIDER" } ] }
      ]
    },
    "deactivate_condition": { "not": { "u_has_trait": "ARM_SPIDER_LOWER" } },
    "effect": [
      { "u_message": "Upper spider senses tingling titillatingly" },
      {
        "arithmetic": [
          { "u_val": "var", "var_name": "arms_spider_lower_good", "type": "progress", "context": "mutation" },
          "+=",
          { "const": 1 }
        ]
      },
      { "arithmetic": [ { "u_val": "vitamin", "name": "mutagen_spider" }, "-=", { "const": 100 } ] },
      {
        "queue_eocs": [
          {
            "id": "arms_spider_lower_sleep",
            "//": "Checks if you're asleep (and the more dramatic changes can happen) or not (to trigger the adjustment EOCs)",
            "condition": { "u_has_effect": "sleep" },
            "false_effect": [
              {
                "queue_eocs": [
                  {
                    "id": "arms_spider_lower_awake",
                    "//": "Prints a hint if you'd need more mutagen for the progression, reminds you to sleep well.",
                    "condition": { "compare_int": [ { "u_val": "vitamin", "name": "mutagen_spider" }, "<", { "const": 400 } ] },
                    "effect": [ { "u_message": "<mutagen_spider>", "snippet": true } ],
                    "false_effect": [ { "u_message": "Spin a web and rest.  You need to gather your strength." } ]
                  }
                ]
              },
              { "weighted_list_eocs": [ [ "eoc_null", 1 ] ] }
            ],
            "effect": [
              {
                "queue_eocs": [
                  {
                    "id": "arms_spider_lower_progress",
                    "condition": {
                      "and": [
                        { "u_has_trait": "ARM_SPIDER_LOWER" },
                        { "u_has_trait": "THRESH_SPIDER" },
                        {
                          "compare_int": [ { "u_val": "vitamin", "name": "mutagen_spider" }, ">=", { "const": 500 } ]
                        },
                        {
                          "u_compare_var": "arms_spider_lower_good",
                          "type": "progress",
                          "context": "mutation",
                          "op": ">",
                          "value": 7
                        }
                      ]
                    },
                    "false_effect": [ { "u_message": "<arms_spider_dream>", "snippet": true, "popup": true } ],
                    "effect": [
                      { "u_message": "<arms_spider_lower_success>", "snippet": true, "popup": true },
                      { "u_lose_effect": "sleep" },
                      { "u_lose_var": "arms_spider_lower_good", "type": "progress", "context": "mutation" },
                      { "u_lose_trait": "ARM_SPIDER_LOWER" },
                      { "u_add_trait": "ARM_SPIDER_LOWER_GOOD" },
                      { "arithmetic": [ { "u_val": "vitamin", "name": "mutagen_spider" }, "-=", { "const": 500 } ] }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "eyes_ceph_check",
    "//": "Active if you have the intermediary cephalopod eyes",
    "recurrence_min": "8 h",
    "recurrence_max": "12 h",
    "condition": { "and": [ "u_can_see", { "u_has_trait": "CEPH_EYES" }, { "not": { "u_has_trait": "CEPH_VISION" } } ] },
    "deactivate_condition": { "not": { "u_has_trait": "CEPH_EYES" } },
    "effect": [
      {
        "queue_eocs": [
          {
            "id": "eyes_ceph_counter",
            "//": "Progresses a counter regardless of threshold/value etc",
            "effect": [
              {
                "arithmetic": [ { "u_val": "var", "var_name": "ceph_vision", "type": "progress", "context": "mutation" }, "+=", { "const": 1 } ]
              }
            ]
          },
          {
            "id": "eyes_ceph_progress",
            "//": "Post-thresh, mid-length adjustment period",
            "condition": {
              "and": [
                { "u_has_trait": "CEPH_EYES" },
                { "u_compare_var": "ceph_vision", "type": "progress", "context": "mutation", "op": ">", "value": 7 },
                { "u_has_trait": "THRESH_CEPHALOPOD" }
              ]
            },
            "false_effect": [
              { "u_message": "<eyes_ceph>", "snippet": true, "type": "bad" },
              { "arithmetic": [ { "u_val": "stored_kcal" }, "-=", { "const": 10 } ] },
              { "arithmetic": [ { "u_val": "pain" }, "+=", { "const": 10 } ] },
              {
                "weighted_list_eocs": [ [ "eoc_null", 13 ], [ "eoc_vision_glare", 10 ], [ "eoc_vision_blind", 1 ], [ "eoc_vision_stun", 2 ] ]
              }
            ],
            "effect": [
              { "u_message": "Your vision fades for a moment, only to return…better!", "type": "mixed" },
              { "u_add_effect": "blind", "duration": "5 s" },
              { "u_lose_trait": "CEPH_EYES" },
              { "u_add_trait": "CEPH_VISION" },
              { "u_lose_var": "ceph_vision", "type": "progress", "context": "mutation" },
              { "arithmetic": [ { "u_val": "stored_kcal" }, "-=", { "const": 250 } ] }
            ]
          }
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "eyes_compound_check",
    "//": "Active if you have the intermediary compund eyes",
    "recurrence_min": "8 h",
    "recurrence_max": "12 h",
    "condition": { "and": [ "u_can_see", { "u_has_trait": "COMPOUND_EYES" }, { "not": { "u_has_trait": "COMPOUND_VISION" } } ] },
    "deactivate_condition": { "not": { "u_has_trait": "COMPOUND_EYES" } },
    "effect": [
      {
        "queue_eocs": [
          {
            "id": "eyes_compound_counter",
            "//": "Progresses a counter regardless of threshold/value etc",
            "effect": [
              {
                "arithmetic": [ { "u_val": "var", "var_name": "compound_vision", "type": "progress", "context": "mutation" }, "+=", { "const": 1 } ]
              }
            ]
          },
          {
            "id": "eyes_compound_progress",
            "//": "This type of change is threshold-only, and you need a long time to get used to it.",
            "condition": {
              "and": [
                { "u_has_trait": "COMPOUND_EYES" },
                {
                  "u_compare_var": "compound_vision",
                  "type": "progress",
                  "context": "mutation",
                  "op": ">",
                  "value": 12
                },
                { "u_has_trait": "THRESH_INSECT" }
              ]
            },
            "false_effect": [
              { "u_message": "<eyes_compound>", "snippet": true, "type": "bad" },
              { "arithmetic": [ { "u_val": "stored_kcal" }, "-=", { "const": 10 } ] },
              { "arithmetic": [ { "u_val": "pain" }, "+=", { "const": 10 } ] },
              { "weighted_list_eocs": [ [ "eoc_null", 11 ], [ "eoc_vision_blind", 1 ], [ "eoc_vision_stun", 10 ] ] }
            ],
            "effect": [
              { "u_message": "The disjointed mosaic of your sight suddenly becomes clear…er!", "type": "mixed" },
              { "u_add_effect": "stunned", "duration": "2 s" },
              { "u_lose_trait": "COMPOUND_EYES" },
              { "u_add_trait": "COMPOUND_VISION" },
              { "u_lose_var": "compund_vision", "type": "progress", "context": "mutation" },
              { "arithmetic": [ { "u_val": "stored_kcal" }, "-=", { "const": 500 } ] }
            ]
          }
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "eyes_elfa_check",
    "//": "Active if you have the intermediary elfa eyes",
    "recurrence_min": "8 h",
    "recurrence_max": "12 h",
    "condition": { "and": [ "u_can_see", { "u_has_trait": "ELFA_NV" }, { "not": { "u_has_trait": "ELFA_FNV" } } ] },
    "deactivate_condition": { "not": { "u_has_trait": "ELFA_NV" } },
    "effect": [
      {
        "queue_eocs": [
          {
            "id": "eyes_elfa_counter",
            "//": "Progresses a counter regardless of threshold/value etc",
            "effect": [
              {
                "arithmetic": [ { "u_val": "var", "var_name": "elfa_fnv", "type": "progress", "context": "mutation" }, "+=", { "const": 1 } ]
              }
            ]
          },
          {
            "id": "eyes_elfa_progress",
            "//": "Drastic optimization, so keeps the mid-length timer but no threshol requirement",
            "condition": {
              "and": [
                { "u_has_trait": "ELFA_NV" },
                { "u_compare_var": "elfa_fnv", "type": "progress", "context": "mutation", "op": ">", "value": 7 }
              ]
            },
            "false_effect": [
              { "u_message": "<eyes_elfa>", "snippet": true, "type": "bad" },
              { "arithmetic": [ { "u_val": "stored_kcal" }, "-=", { "const": 10 } ] },
              { "arithmetic": [ { "u_val": "pain" }, "+=", { "const": 10 } ] },
              { "weighted_list_eocs": [ [ "eoc_null", 11 ], [ "eoc_vision_blind", 5 ], [ "eoc_vision_hallu", 5 ] ] }
            ],
            "effect": [
              { "u_message": "Your vision grows blurry, then the world snaps back into focus with dizzying speed.", "type": "mixed" },
              { "u_add_effect": "stunned", "duration": "5 s" },
              { "u_lose_trait": "ELFA_NV" },
              { "u_add_trait": "ELFA_FNV" },
              { "u_lose_var": "elfa_fnv", "type": "progress", "context": "mutation" }
            ]
          }
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "eyes_feline_check",
    "//": "Active if you have the intermediary feline eyes",
    "recurrence_min": "8 h",
    "recurrence_max": "12 h",
    "condition": { "and": [ "u_can_see", { "u_has_trait": "FEL_EYE" }, { "not": { "u_has_trait": "FEL_NV" } } ] },
    "deactivate_condition": { "not": { "u_has_trait": "FEL_EYE" } },
    "effect": [
      {
        "queue_eocs": [
          {
            "id": "eyes_feline_counter",
            "//": "Progresses a counter regardless of threshold/value etc",
            "effect": [
              {
                "arithmetic": [ { "u_val": "var", "var_name": "fel_nv", "type": "progress", "context": "mutation" }, "+=", { "const": 1 } ]
              }
            ]
          },
          {
            "id": "eyes_feline_progress",
            "//": "Mammal eyes, so less adjustment and no threshold needed.",
            "condition": {
              "and": [
                { "u_has_trait": "FEL_EYE" },
                { "u_compare_var": "fel_nv", "type": "progress", "context": "mutation", "op": ">", "value": 4 }
              ]
            },
            "false_effect": [
              { "u_message": "<eyes_feline>", "snippet": true, "type": "bad" },
              { "arithmetic": [ { "u_val": "stored_kcal" }, "-=", { "const": 10 } ] },
              { "weighted_list_eocs": [ [ "eoc_null", 10 ], [ "eoc_vision_glare", 5 ], [ "eoc_vision_stun", 5 ] ] }
            ],
            "effect": [
              { "u_message": "The world suddenly grows brighter.", "type": "mixed" },
              { "u_add_effect": "glare", "duration": "30 m" },
              { "u_lose_trait": "FEL_EYES" },
              { "u_add_trait": "FEL_NV" },
              { "u_lose_var": "fel_nv", "type": "progress", "context": "mutation" }
            ]
          }
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "eyes_snail_check",
    "//": "Active if you have the intermediary snail eyes",
    "recurrence_min": "8 h",
    "recurrence_max": "12 h",
    "condition": { "and": [ "u_can_see", { "u_has_trait": "EYESTALKS1" }, { "not": { "u_has_trait": "EYESTALKS2" } } ] },
    "deactivate_condition": { "not": { "u_has_trait": "EYESTALKS1" } },
    "effect": [
      {
        "queue_eocs": [
          {
            "id": "eyes_snail_counter",
            "//": "Progresses a counter regardless of threshold/value etc",
            "effect": [
              {
                "arithmetic": [ { "u_val": "var", "var_name": "eyestalks2", "type": "progress", "context": "mutation" }, "+=", { "const": 1 } ]
              }
            ]
          },
          {
            "id": "eyes_snail_progress",
            "//": "Big change, long adjustment and threshold req",
            "condition": {
              "and": [
                { "u_has_trait": "EYESTALKS1" },
                { "u_compare_var": "eyestalks2", "type": "progress", "context": "mutation", "op": ">", "value": 12 },
                { "u_has_trait": "THRESH_GASTROPOD" }
              ]
            },
            "false_effect": [
              { "u_message": "<eyes_snail>", "snippet": true, "type": "bad" },
              { "arithmetic": [ { "u_val": "stored_kcal" }, "-=", { "const": 150 } ] },
              { "arithmetic": [ { "u_val": "pain" }, "+=", { "const": 15 } ] },
              { "weighted_list_eocs": [ [ "eoc_null", 5 ], [ "eoc_vision_blind", 5 ], [ "eoc_vision_stun", 5 ] ] }
            ],
            "effect": [
              { "u_message": "Your vision flips for the last time, and you wiggle your eyestalks.", "type": "mixed" },
              { "u_add_effect": "stunned", "duration": "3 s" },
              { "u_lose_trait": "EYESTALKS1" },
              { "u_add_trait": "EYESTALKS2" },
              { "u_lose_var": "eyestalks2", "type": "progress", "context": "mutation" }
            ]
          }
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "eyes_lizard_check",
    "//": "Active if you have the intermediary lizard eyes",
    "recurrence_min": "8 h",
    "recurrence_max": "12 h",
    "condition": { "and": [ "u_can_see", { "u_has_trait": "LIZ_EYE" }, { "not": { "u_has_trait": "LIZ_IR" } } ] },
    "deactivate_condition": { "not": { "u_has_trait": "LIZ_IR" } },
    "effect": [
      {
        "queue_eocs": [
          {
            "id": "eyes_lizard_counter",
            "//": "Progresses a counter regardless of threshold/value etc",
            "effect": [
              {
                "arithmetic": [ { "u_val": "var", "var_name": "liz_ir", "type": "progress", "context": "mutation" }, "+=", { "const": 1 } ]
              }
            ]
          },
          {
            "id": "eyes_lizard_progress",
            "//": "Mid-length adjustment, threshold required",
            "condition": {
              "and": [
                { "u_has_trait": "LIZ_EYE" },
                { "u_compare_var": "liz_ir", "type": "progress", "context": "mutation", "op": ">", "value": 7 },
                { "or": [ { "u_has_trait": "THRESH_RAPTOR" }, { "u_has_trait": "THRESH_LIZARD" } ] }
              ]
            },
            "false_effect": [
              { "u_message": "<eyes_lizard>", "snippet": true, "type": "bad" },
              { "arithmetic": [ { "u_val": "stored_kcal" }, "-=", { "const": 10 } ] },
              { "weighted_list_eocs": [ [ "eoc_null", 10 ], [ "eoc_vision_blind", 5 ], [ "eoc_vision_glare", 5 ] ] }
            ],
            "effect": [
              { "u_message": "Your vision fades for a moment.", "type": "mixed" },
              { "u_add_effect": "blind", "duration": "2 s" },
              { "u_lose_trait": "LIZ_EYE" },
              { "u_add_trait": "LIZ_IR" },
              { "u_lose_var": "liz_ir", "type": "progress", "context": "mutation" }
            ]
          }
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "eoc_skin_shedding",
    "recurrence_min": "36 h",
    "recurrence_max": "72 h",
    "condition": { "u_has_trait": "SKIN_SHEDDING" },
    "deactivate_condition": { "not": { "u_has_trait": "SKIN_SHEDDING" } },
    "effect": [
      { "u_message": "Your skin starts flaking off.", "type": "bad" },
      { "u_add_effect": "formication", "duration": "6 h", "intensity": 2, "target_part": "RANDOM" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_BIOLUM3_activated",
    "condition": { "compare_int": [ { "u_val": "stamina" }, ">=", { "const": 3000 } ] },
    "effect": [
      { "u_assign_activity": "ACT_GENERIC_EOC", "duration": "3 seconds" },
      { "arithmetic": [ { "u_val": "stamina" }, "-=", { "const": 700 } ] },
      { "queue_eocs": [ "EOC_BIOLUM3_cast" ], "time_in_future_min": 2, "time_in_future_max": 2 }
    ],
    "false_effect": [ { "u_message": "You don't have enough stamina to activate your Bioluminescent Flare.", "type": "bad" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_BIOLUM3_cast",
    "effect": [
      {
        "u_cast_spell": { "id": "spell_spit_flare", "message": "You launch a glob of bioluminescent material!" },
        "targeted": true
      }
    ]
  }
]
